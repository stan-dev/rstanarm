<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><!-- upstream: inst/BS5/templates/head.html; pkgdown-version: 2.1.3, fe04924 --><!-- https://github.com/r-lib/pkgdown/tree/fe04924b3df129bea60ac871614b01d87bcae147 --><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Graphical posterior predictive checks — pp_check.stanreg • rstanarm</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><!-- mathjax math --><script id="MathJax-script" defer src="https://cdn.jsdelivr.net/npm/mathjax@4.0.0/tex-mml-chtml.js" integrity="sha256-qoRlVrS5NAnXSSSiMfFXwK8C9obG11Iybe4h2+bQYR4=" crossorigin="anonymous">
  </script><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_3-0.4.10/font.css" rel="stylesheet"><link href="../deps/Source_Code_Pro-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- Font Awesome 7.0.1 for Bluesky icon --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css" referrerpolicy="no-referrer"><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Graphical posterior predictive checks — pp_check.stanreg"><meta name="description" content="Interface to the PPC (posterior predictive checking) module
in the bayesplot package, providing various plots comparing the
observed outcome variable \(y\) to simulated datasets \(y^{rep}\)
from the posterior predictive distribution. The pp_check method for
stanreg-objects prepares the arguments required for the specified
bayesplot PPC plotting function and then calls that function. It is
also straightforward to use the functions from the bayesplot package
directly rather than via the pp_check method. Examples of both are
given below."><meta property="og:description" content="Interface to the PPC (posterior predictive checking) module
in the bayesplot package, providing various plots comparing the
observed outcome variable \(y\) to simulated datasets \(y^{rep}\)
from the posterior predictive distribution. The pp_check method for
stanreg-objects prepares the arguments required for the specified
bayesplot PPC plotting function and then calls that function. It is
also straightforward to use the functions from the bayesplot package
directly rather than via the pp_check method. Examples of both are
given below."><meta property="og:image" content="https://mc-stan.org/rstanarm/logo.svg"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <!-- upstream: inst/BS5/templates/navbar.html; pkgdown-version: 2.1.3, fe04924 -->
<!-- https://github.com/r-lib/pkgdown/tree/fe04924b3df129bea60ac871614b01d87bcae147 -->
<nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">


    <a class="navbar-brand me-2" href="../index.html">
      <!-- Add Stan logo -->
      <picture><source type="image/svg+xml" srcset="../logo.svg"><img src="../logo.png" class="stan-logo" alt="Stan blue hex logo"></source></picture>
      rstanarm
    </a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">2.32.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html" aria-label="Go to homepage"><span class="fa fa-home fa-lg"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html">Vignettes</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-other-packages" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Other Packages</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-other-packages"><li><a class="external-link dropdown-item" href="https://mc-stan.org/bayesplot">bayesplot</a></li>
    <li><a class="external-link dropdown-item" href="https://mc-stan.org/cmdstanr">cmdstanr</a></li>
    <li><a class="external-link dropdown-item" href="https://mc-stan.org/loo">loo</a></li>
    <li><a class="external-link dropdown-item" href="https://mc-stan.org/posterior">posterior</a></li>
    <li><a class="external-link dropdown-item" href="https://mc-stan.org/projpred">projpred</a></li>
    <li><a class="external-link dropdown-item" href="https://mc-stan.org/rstan">rstan</a></li>
    <li><a class="external-link dropdown-item" href="https://mc-stan.org/rstantools">rstantools</a></li>
    <li><a class="external-link dropdown-item" href="https://mc-stan.org/shinystan">shinystan</a></li>
  </ul></li>
<li class="nav-item"><a class="external-link nav-link" href="https://mc-stan.org/about/">About Stan</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://bsky.app/profile/did:plc:qznndgdnkem2yryu7ipqbpv7" aria-label="Visit our Bluesky profile"><span class="fa fa-brands fa-bluesky"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://discourse.mc-stan.org/" aria-label="Visit our forums"><span class="fa fa-users"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/stan-dev/rstanarm/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Graphical posterior predictive checks</h1>
      <small class="dont-index">Source: <a href="https://github.com/stan-dev/rstanarm/blob/New-pkgdown-theme/R/pp_check.R" class="external-link"><code>R/pp_check.R</code></a></small>
      <div class="d-none name"><code>pp_check.stanreg.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Interface to the <a href="https://mc-stan.org/bayesplot/reference/PPC-overview.html" class="external-link">PPC</a> (posterior predictive checking) module
in the <span class="pkg"><a href="https://mc-stan.org/bayesplot/reference/bayesplot-package.html" class="external-link">bayesplot</a></span> package, providing various plots comparing the
observed outcome variable \(y\) to simulated datasets \(y^{rep}\)
from the posterior predictive distribution. The <code>pp_check</code> method for
<a href="stanreg-objects.html">stanreg-objects</a> prepares the arguments required for the specified
<span class="pkg">bayesplot</span> PPC plotting function and then calls that function. It is
also straightforward to use the functions from the <span class="pkg">bayesplot</span> package
directly rather than via the <code>pp_check</code> method. Examples of both are
given below.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for class 'stanreg'</span></span>
<span><span class="fu">pp_check</span><span class="op">(</span><span class="va">object</span>, plotfun <span class="op">=</span> <span class="st">"dens_overlay"</span>, nreps <span class="op">=</span> <span class="cn">NULL</span>, seed <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>A fitted model object returned by one of the
<span class="pkg">rstanarm</span> modeling functions. See <code><a href="stanreg-objects.html">stanreg-objects</a></code>.</p></dd>


<dt id="arg-plotfun">plotfun<a class="anchor" aria-label="anchor" href="#arg-plotfun"></a></dt>
<dd><p>A character string naming the <span class="pkg">bayesplot</span>
<a href="https://mc-stan.org/bayesplot/reference/PPC-overview.html" class="external-link">PPC</a> function to use. The default is to call
<code><a href="https://mc-stan.org/bayesplot/reference/PPC-distributions.html" class="external-link">ppc_dens_overlay</a></code>. <code>plotfun</code> can be specified
either as the full name of a <span class="pkg">bayesplot</span> plotting function (e.g.
<code>"ppc_hist"</code>) or can be abbreviated to the part of the name following
the <code>"ppc_"</code> prefix (e.g. <code>"hist"</code>). To get the names of all
available PPC functions see <code><a href="https://mc-stan.org/bayesplot/reference/available_ppc.html" class="external-link">available_ppc</a></code>.</p></dd>


<dt id="arg-nreps">nreps<a class="anchor" aria-label="anchor" href="#arg-nreps"></a></dt>
<dd><p>The number of \(y^{rep}\) datasets to generate from the
<a href="posterior_predict.stanreg.html">posterior predictive distribution</a> and show in
the plots. The default depends on <code>plotfun</code>. For functions that plot
each <code>yrep</code> dataset separately (e.g. <code>ppc_hist</code>), <code>nreps</code>
defaults to a small value to make the plots readable. For functions that
overlay many <code>yrep</code> datasets (e.g., <code>ppc_dens_overlay</code>) a larger
number is used by default, and for other functions (e.g. <code>ppc_stat</code>)
the default is to set <code>nreps</code> equal to the posterior sample size.</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>An optional <code><a href="https://rdrr.io/r/base/Random.html" class="external-link">seed</a></code> to pass to
<code><a href="posterior_predict.stanreg.html">posterior_predict</a></code>.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additonal arguments passed to the <span class="pkg"><a href="https://mc-stan.org/bayesplot/reference/bayesplot-package.html" class="external-link">bayesplot</a></span> function
called. For many plotting functions <code>...</code> is optional, however for
functions that require a <code>group</code> or <code>x</code> argument, these arguments
should be specified in <code>...</code>. If specifying <code>group</code> and/or
<code>x</code>, they can be provided as either strings naming variables (in which
case they are searched for in the model frame) or as vectors containing the
actual values of the variables. See the <strong>Examples</strong> section, below.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>pp_check</code> returns a ggplot object that can be further
  customized using the <span class="pkg">ggplot2</span> package.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>For binomial data, plots of \(y\) and \(y^{rep}\) show the
  proportion of 'successes' rather than the raw count. Also for binomial
  models see <code><a href="https://mc-stan.org/bayesplot/reference/PPC-errors.html" class="external-link">ppc_error_binned</a></code> for binned residual
  plots.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Gelman, A., Carlin, J. B., Stern, H. S., Dunson, D. B., Vehtari,
  A., and Rubin, D. B. (2013). <em>Bayesian Data Analysis.</em> Chapman &amp; Hall/CRC
  Press, London, third edition. (Ch. 6)</p>
<p>Gabry, J. , Simpson, D. , Vehtari, A. , Betancourt, M. and
  Gelman, A. (2019), Visualization in Bayesian workflow. <em>J. R. Stat.
  Soc. A</em>, 182: 389-402. doi:10.1111/rssa.12378,
  <a href="https://arxiv.org/abs/1709.01449" class="external-link">arXiv preprint</a>,
  <a href="https://github.com/jgabry/bayes-vis-paper" class="external-link">code on GitHub</a>)</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index">
<ul><li><p>The vignettes in the <span class="pkg">bayesplot</span> package for many examples.
    Examples of posterior predictive checks can also be found in the
    <span class="pkg">rstanarm</span> vignettes and demos.</p></li>
<li><p><code><a href="https://mc-stan.org/bayesplot/reference/PPC-overview.html" class="external-link">PPC-overview</a></code> (<span class="pkg">bayesplot</span>) for links to
    the documentation for all the available plotting functions.</p></li>
<li><p><code><a href="posterior_predict.stanreg.html">posterior_predict</a></code> for drawing from the posterior
    predictive distribution.</p></li>
<li><p><code><a href="https://mc-stan.org/bayesplot/reference/bayesplot-colors.html" class="external-link">color_scheme_set</a></code> to change the color scheme
    of the plots.</p></li>
</ul></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="va">.Platform</span><span class="op">$</span><span class="va">OS.type</span> <span class="op">!=</span> <span class="st">"windows"</span> <span class="op">||</span> <span class="va">.Platform</span><span class="op">$</span><span class="va">r_arch</span> <span class="op">!=</span> <span class="st">"i386"</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="stan_glmer.html">stan_glmer</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">mpg</span> <span class="op">~</span> <span class="va">wt</span> <span class="op">+</span> <span class="va">am</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">cyl</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">mtcars</span>,</span></span>
<span class="r-in"><span>  iter <span class="op">=</span> <span class="fl">400</span>, <span class="co"># iter and chains small just to keep example quick</span></span></span>
<span class="r-in"><span>  chains <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>  refresh <span class="op">=</span> <span class="fl">0</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compare distribution of y to distributions of multiple yrep datasets</span></span></span>
<span class="r-in"><span><span class="fu">pp_check</span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">pp_check</span><span class="op">(</span><span class="va">fit</span>, plotfun <span class="op">=</span> <span class="st">"boxplot"</span>, nreps <span class="op">=</span> <span class="fl">10</span>, notch <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">pp_check</span><span class="op">(</span><span class="va">fit</span>, plotfun <span class="op">=</span> <span class="st">"hist"</span>, nreps <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># Same plot (up to RNG noise) using bayesplot package directly</span></span></span>
<span class="r-in"><span><span class="fu">bayesplot</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/bayesplot/reference/PPC-distributions.html" class="external-link">ppc_hist</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">mtcars</span><span class="op">$</span><span class="va">mpg</span>, yrep <span class="op">=</span> <span class="fu"><a href="posterior_predict.stanreg.html">posterior_predict</a></span><span class="op">(</span><span class="va">fit</span>, draws <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Check histograms of test statistics by level of grouping variable 'cyl'</span></span></span>
<span class="r-in"><span><span class="fu">pp_check</span><span class="op">(</span><span class="va">fit</span>, plotfun <span class="op">=</span> <span class="st">"stat_grouped"</span>, stat <span class="op">=</span> <span class="st">"median"</span>, group <span class="op">=</span> <span class="st">"cyl"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Defining a custom test statistic</span></span></span>
<span class="r-in"><span><span class="va">q25</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">y</span>, probs <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">pp_check</span><span class="op">(</span><span class="va">fit</span>, plotfun <span class="op">=</span> <span class="st">"stat_grouped"</span>, stat <span class="op">=</span> <span class="st">"q25"</span>, group <span class="op">=</span> <span class="st">"cyl"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Scatterplot of two test statistics</span></span></span>
<span class="r-in"><span><span class="fu">pp_check</span><span class="op">(</span><span class="va">fit</span>, plotfun <span class="op">=</span> <span class="st">"stat_2d"</span>, stat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mean"</span>, <span class="st">"sd"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Scatterplot of y vs. average yrep</span></span></span>
<span class="r-in"><span><span class="fu">pp_check</span><span class="op">(</span><span class="va">fit</span>, plotfun <span class="op">=</span> <span class="st">"scatter_avg"</span><span class="op">)</span> <span class="co"># y vs. average yrep</span></span></span>
<span class="r-in"><span><span class="co"># Same plot (up to RNG noise) using bayesplot package directly</span></span></span>
<span class="r-in"><span><span class="fu">bayesplot</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/bayesplot/reference/PPC-scatterplots.html" class="external-link">ppc_scatter_avg</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">mtcars</span><span class="op">$</span><span class="va">mpg</span>, yrep <span class="op">=</span> <span class="fu"><a href="posterior_predict.stanreg.html">posterior_predict</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Scatterplots of y vs. several individual yrep datasets</span></span></span>
<span class="r-in"><span><span class="fu">pp_check</span><span class="op">(</span><span class="va">fit</span>, plotfun <span class="op">=</span> <span class="st">"scatter"</span>, nreps <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Same plot (up to RNG noise) using bayesplot package directly</span></span></span>
<span class="r-in"><span><span class="fu">bayesplot</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/bayesplot/reference/PPC-scatterplots.html" class="external-link">ppc_scatter</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">mtcars</span><span class="op">$</span><span class="va">mpg</span>, yrep <span class="op">=</span> <span class="fu"><a href="posterior_predict.stanreg.html">posterior_predict</a></span><span class="op">(</span><span class="va">fit</span>, draws <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># yrep intervals with y points overlaid</span></span></span>
<span class="r-in"><span><span class="co"># by default 1:length(y) used on x-axis but can also specify an x variable</span></span></span>
<span class="r-in"><span><span class="fu">pp_check</span><span class="op">(</span><span class="va">fit</span>, plotfun <span class="op">=</span> <span class="st">"intervals"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">pp_check</span><span class="op">(</span><span class="va">fit</span>, plotfun <span class="op">=</span> <span class="st">"intervals"</span>, x <span class="op">=</span> <span class="st">"wt"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"wt"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Same plot (up to RNG noise) using bayesplot package directly</span></span></span>
<span class="r-in"><span><span class="fu">bayesplot</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/bayesplot/reference/PPC-intervals.html" class="external-link">ppc_intervals</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">mtcars</span><span class="op">$</span><span class="va">mpg</span>, yrep <span class="op">=</span> <span class="fu"><a href="posterior_predict.stanreg.html">posterior_predict</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                         x <span class="op">=</span> <span class="va">mtcars</span><span class="op">$</span><span class="va">wt</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"wt"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># predictive errors</span></span></span>
<span class="r-in"><span><span class="fu">pp_check</span><span class="op">(</span><span class="va">fit</span>, plotfun <span class="op">=</span> <span class="st">"error_hist"</span>, nreps <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">pp_check</span><span class="op">(</span><span class="va">fit</span>, plotfun <span class="op">=</span> <span class="st">"error_scatter_avg_vs_x"</span>, x <span class="op">=</span> <span class="st">"wt"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"wt"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example of a PPC for ordinal models (stan_polr)</span></span></span>
<span class="r-in"><span><span class="va">fit2</span> <span class="op">&lt;-</span> <span class="fu"><a href="stan_polr.html">stan_polr</a></span><span class="op">(</span><span class="va">tobgp</span> <span class="op">~</span> <span class="va">agegp</span>, data <span class="op">=</span> <span class="va">esoph</span>, method <span class="op">=</span> <span class="st">"probit"</span>,</span></span>
<span class="r-in"><span>                  prior <span class="op">=</span> <span class="fu"><a href="priors.html">R2</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="st">"mean"</span><span class="op">)</span>, init_r <span class="op">=</span> <span class="fl">0.1</span>,</span></span>
<span class="r-in"><span>                  refresh <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">pp_check</span><span class="op">(</span><span class="va">fit2</span>, plotfun <span class="op">=</span> <span class="st">"bars"</span>, nreps <span class="op">=</span> <span class="fl">500</span>, prob <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">pp_check</span><span class="op">(</span><span class="va">fit2</span>, plotfun <span class="op">=</span> <span class="st">"bars_grouped"</span>, group <span class="op">=</span> <span class="va">esoph</span><span class="op">$</span><span class="va">agegp</span>,</span></span>
<span class="r-in"><span>         nreps <span class="op">=</span> <span class="fl">500</span>, prob <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>There were 3 divergent transitions after warmup. See</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> https://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> to find out why this is a problem and how to eliminate them.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Examine the pairs() plot to diagnose sampling problems</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>The largest R-hat is 1.07, indicating chains have not mixed.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> Running the chains for more iterations may help. See</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> https://mc-stan.org/misc/warnings.html#r-hat</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Bulk Effective Samples Size (ESS) is too low, indicating posterior means and medians may be unreliable.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> Running the chains for more iterations may help. See</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> https://mc-stan.org/misc/warnings.html#bulk-ess</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Tail Effective Samples Size (ESS) is too low, indicating posterior variances and tail quantiles may be unreliable.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> Running the chains for more iterations may help. See</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> https://mc-stan.org/misc/warnings.html#tail-ess</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Markov chains did not converge! Do not analyze results!</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in get(as.character(FUN), mode = "function", envir = envir):</span> object 'q25' of mode 'function' was not found</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jonah Gabry, Ben Goodrich.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

