<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><!-- upstream: inst/BS5/templates/head.html; pkgdown-version: 2.1.3, fe04924 --><!-- https://github.com/r-lib/pkgdown/tree/fe04924b3df129bea60ac871614b01d87bcae147 --><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Bayesian joint longitudinal and time-to-event models via Stan — stan_jm • rstanarm</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_3-0.4.10/font.css" rel="stylesheet"><link href="../deps/Source_Code_Pro-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- Font Awesome 7.0.1 for Bluesky icon --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css" referrerpolicy="no-referrer"><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Bayesian joint longitudinal and time-to-event models via Stan — stan_jm"><meta name="description" content="
Fits a shared parameter joint model for longitudinal and time-to-event
(e.g. survival) data under a Bayesian framework using Stan."><meta property="og:description" content="
Fits a shared parameter joint model for longitudinal and time-to-event
(e.g. survival) data under a Bayesian framework using Stan."><meta property="og:image" content="https://mc-stan.org/rstanarm/logo.svg"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <!-- upstream: inst/BS5/templates/navbar.html; pkgdown-version: 2.1.3, fe04924 -->
<!-- https://github.com/r-lib/pkgdown/tree/fe04924b3df129bea60ac871614b01d87bcae147 -->
<nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">


    <a class="navbar-brand me-2" href="../index.html">
      <!-- Add Stan logo -->
      <picture><source type="image/svg+xml" srcset="../logo.svg"><img src="../logo.png" class="stan-logo" alt="Stan blue hex logo"></source></picture>
      rstanarm
    </a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.32.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html" aria-label="Go to homepage"><span class="fa fa-home fa-lg"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html">Vignettes</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-other-packages" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Other Packages</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-other-packages"><li><a class="external-link dropdown-item" href="https://mc-stan.org/bayesplot">bayesplot</a></li>
    <li><a class="external-link dropdown-item" href="https://mc-stan.org/cmdstanr">cmdstanr</a></li>
    <li><a class="external-link dropdown-item" href="https://mc-stan.org/loo">loo</a></li>
    <li><a class="external-link dropdown-item" href="https://mc-stan.org/posterior">posterior</a></li>
    <li><a class="external-link dropdown-item" href="https://mc-stan.org/projpred">projpred</a></li>
    <li><a class="external-link dropdown-item" href="https://mc-stan.org/rstan">rstan</a></li>
    <li><a class="external-link dropdown-item" href="https://mc-stan.org/rstantools">rstantools</a></li>
    <li><a class="external-link dropdown-item" href="https://mc-stan.org/shinystan">shinystan</a></li>
  </ul></li>
<li class="nav-item"><a class="external-link nav-link" href="https://mc-stan.org/about/">About Stan</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://bsky.app/profile/did:plc:qznndgdnkem2yryu7ipqbpv7" aria-label="Visit our Bluesky profile"><span class="fa fa-brands fa-bluesky"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://discourse.mc-stan.org/" aria-label="Visit our forums"><span class="fa fa-users"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/stan-dev/rstanarm/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Bayesian joint longitudinal and time-to-event models via Stan</h1>
      <small class="dont-index">Source: <a href="https://github.com/stan-dev/rstanarm/blob/New-pkgdown-theme/R/stan_jm.R" class="external-link"><code>R/stan_jm.R</code></a></small>
      <div class="d-none name"><code>stan_jm.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>
Fits a shared parameter joint model for longitudinal and time-to-event
(e.g. survival) data under a Bayesian framework using Stan.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">stan_jm</span><span class="op">(</span></span>
<span>  <span class="va">formulaLong</span>,</span>
<span>  <span class="va">dataLong</span>,</span>
<span>  <span class="va">formulaEvent</span>,</span>
<span>  <span class="va">dataEvent</span>,</span>
<span>  <span class="va">time_var</span>,</span>
<span>  <span class="va">id_var</span>,</span>
<span>  family <span class="op">=</span> <span class="va">gaussian</span>,</span>
<span>  assoc <span class="op">=</span> <span class="st">"etavalue"</span>,</span>
<span>  lag_assoc <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  <span class="va">grp_assoc</span>,</span>
<span>  scale_assoc <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  epsilon <span class="op">=</span> <span class="fl">1e-05</span>,</span>
<span>  basehaz <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"bs"</span>, <span class="st">"weibull"</span>, <span class="st">"piecewise"</span><span class="op">)</span>,</span>
<span>  <span class="va">basehaz_ops</span>,</span>
<span>  qnodes <span class="op">=</span> <span class="fl">15</span>,</span>
<span>  init <span class="op">=</span> <span class="st">"prefit"</span>,</span>
<span>  <span class="va">weights</span>,</span>
<span>  priorLong <span class="op">=</span> <span class="fu"><a href="priors.html">normal</a></span><span class="op">(</span>autoscale <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  priorLong_intercept <span class="op">=</span> <span class="fu"><a href="priors.html">normal</a></span><span class="op">(</span>autoscale <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  priorLong_aux <span class="op">=</span> <span class="fu"><a href="priors.html">cauchy</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5</span>, autoscale <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  priorEvent <span class="op">=</span> <span class="fu"><a href="priors.html">normal</a></span><span class="op">(</span>autoscale <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  priorEvent_intercept <span class="op">=</span> <span class="fu"><a href="priors.html">normal</a></span><span class="op">(</span>autoscale <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  priorEvent_aux <span class="op">=</span> <span class="fu"><a href="priors.html">cauchy</a></span><span class="op">(</span>autoscale <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  priorEvent_assoc <span class="op">=</span> <span class="fu"><a href="priors.html">normal</a></span><span class="op">(</span>autoscale <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  prior_covariance <span class="op">=</span> <span class="fu"><a href="priors.html">lkj</a></span><span class="op">(</span>autoscale <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  prior_PD <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  algorithm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sampling"</span>, <span class="st">"meanfield"</span>, <span class="st">"fullrank"</span><span class="op">)</span>,</span>
<span>  adapt_delta <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  max_treedepth <span class="op">=</span> <span class="fl">10L</span>,</span>
<span>  QR <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  sparse <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-formulalong">formulaLong<a class="anchor" aria-label="anchor" href="#arg-formulalong"></a></dt>
<dd><p>A two-sided linear formula object describing both the
fixed-effects and random-effects parts of the longitudinal submodel,
similar in vein to formula specification in the <strong>lme4</strong> package
(see <code><a href="https://rdrr.io/pkg/lme4/man/glmer.html" class="external-link">glmer</a></code> or the <strong>lme4</strong> vignette for details).
Note however that the double bar (<code>||</code>) notation is not allowed
when specifying the random-effects parts of the formula, and neither
are nested grouping factors (e.g. <code>(1 | g1/g2))</code> or
<code>(1 | g1:g2)</code>, where <code>g1</code>, <code>g2</code> are grouping factors.
Offset terms can also be included in the model formula.
For a multivariate joint model (i.e. more than one longitudinal marker)
this should be a list of such formula objects, with each element
of the list providing the formula for one of the longitudinal submodels.</p></dd>


<dt id="arg-datalong">dataLong<a class="anchor" aria-label="anchor" href="#arg-datalong"></a></dt>
<dd><p>A data frame containing the variables specified in
<code>formulaLong</code>. If fitting a multivariate joint model, then this can
be either a single data frame which contains the data for all
longitudinal submodels, or it can be a list of data frames where each
element of the list provides the data for one of the longitudinal
submodels.</p></dd>


<dt id="arg-formulaevent">formulaEvent<a class="anchor" aria-label="anchor" href="#arg-formulaevent"></a></dt>
<dd><p>A two-sided formula object describing the event
submodel. The left hand side of the formula should be a <code><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv()</a></code>
object. See <code><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></code>.</p></dd>


<dt id="arg-dataevent">dataEvent<a class="anchor" aria-label="anchor" href="#arg-dataevent"></a></dt>
<dd><p>A data frame containing the variables specified in
<code>formulaEvent</code>.</p></dd>


<dt id="arg-time-var">time_var<a class="anchor" aria-label="anchor" href="#arg-time-var"></a></dt>
<dd><p>A character string specifying the name of the variable
in <code>dataLong</code> which represents time.</p></dd>


<dt id="arg-id-var">id_var<a class="anchor" aria-label="anchor" href="#arg-id-var"></a></dt>
<dd><p>A character string specifying the name of the variable in
<code>dataLong</code> which distinguishes between individuals. This can be
left unspecified if there is only one grouping factor (which is assumed
to be the individual). If there is more than one grouping factor (i.e.
clustering beyond the level of the individual) then the <code>id_var</code>
argument must be specified.</p></dd>


<dt id="arg-family">family<a class="anchor" aria-label="anchor" href="#arg-family"></a></dt>
<dd><p>The family (and possibly also the link function) for the
longitudinal submodel(s). See <code><a href="https://rdrr.io/pkg/lme4/man/glmer.html" class="external-link">glmer</a></code> for details.
If fitting a multivariate joint model, then this can optionally be a
list of families, in which case each element of the list specifies the
family for one of the longitudinal submodels.</p></dd>


<dt id="arg-assoc">assoc<a class="anchor" aria-label="anchor" href="#arg-assoc"></a></dt>
<dd><p>A character string or character vector specifying the joint
model association structure. Possible association structures that can
be used include: "etavalue" (the default); "etaslope"; "etaauc";
"muvalue"; "muslope"; "muauc"; "shared_b"; "shared_coef"; or "null".
These are described in the <strong>Details</strong> section below. For a multivariate
joint model, different association structures can optionally be used for
each longitudinal submodel by specifying a list of character
vectors, with each element of the list specifying the desired association
structure for one of the longitudinal submodels. Specifying <code>assoc = NULL</code>
will fit a joint model with no association structure (equivalent
to fitting separate longitudinal and time-to-event models). It is also
possible to include interaction terms between the association term
("etavalue", "etaslope", "muvalue", "muslope") and observed data/covariates.
It is also possible, when fitting a multivariate joint model, to include
interaction terms between the association terms ("etavalue" or "muvalue")
corresponding to the different longitudinal outcomes. See the
<strong>Details</strong> section as well as the <strong>Examples</strong> below.</p></dd>


<dt id="arg-lag-assoc">lag_assoc<a class="anchor" aria-label="anchor" href="#arg-lag-assoc"></a></dt>
<dd><p>A non-negative scalar specifying the time lag that should be
used for the association structure. That is, the hazard of the event at
time <em>t</em> will be assumed to be associated with the value/slope/auc of
the longitudinal marker at time <em>t-u</em>, where <em>u</em> is the time lag.
If fitting a multivariate joint model, then a different time lag can be used
for each longitudinal marker by providing a numeric vector of lags, otherwise
if a scalar is provided then the specified time lag will be used for all
longitudinal markers. Note however that only one time lag  can be specified
for linking each longitudinal marker to the
event, and that that time lag will be used for all association structure
types (e.g. <code>"etavalue"</code>, <code>"etaslope"</code>, <code>"etaauc"</code>,
<code>"muvalue"</code>, etc) that are specified for that longitudinal marker in
the <code>assoc</code> argument.</p></dd>


<dt id="arg-grp-assoc">grp_assoc<a class="anchor" aria-label="anchor" href="#arg-grp-assoc"></a></dt>
<dd><p>Character string specifying the method for combining information
across lower level units clustered within an individual when forming the
association structure. This is only relevant when a grouping factor is
specified in <code>formulaLong</code> that corresponds to clustering within
individuals. This can be specified as either <code>"sum"</code>, <code>mean</code>,
<code>"min"</code> or <code>"max"</code>. For example, specifying <code>grp_assoc = "sum"</code>
indicates that the association structure should be based on a summation across
the lower level units clustered within an individual, or specifying
<code>grp_assoc = "mean"</code>  indicates that the association structure
should be based on the mean (i.e. average) taken across the lower level
units clustered within an individual.
So, for example, specifying <code>assoc = "muvalue"</code>
and <code>grp_assoc = "sum"</code> would mean that the log hazard at time
<em>t</em> for individual <em>i</em> would be linearly related to the sum of
the expected values at time <em>t</em> for each of the lower level
units (which may be for example tumor lesions) clustered within that
individual.</p></dd>


<dt id="arg-scale-assoc">scale_assoc<a class="anchor" aria-label="anchor" href="#arg-scale-assoc"></a></dt>
<dd><p>A non-zero numeric value specifying an optional scaling
parameter for the association structure. This multiplicatively scales the
value/slope/auc of the longitudinal marker by <code>scale_assoc</code> within the
event submodel. When fitting a multivariate joint model, a scaling parameter
must be specified for each longitudinal submodel using a vector of numeric
values. Note that only one scaling parameter can be specified for each
longitudinal submodel, and it will be used for all association structure
types (e.g. <code>"etavalue"</code>, <code>"etaslope"</code>, <code>"etaauc"</code>,
<code>"muvalue"</code>, etc) that are specified for that longitudinal marker in
the <code>assoc</code> argument.</p></dd>


<dt id="arg-epsilon">epsilon<a class="anchor" aria-label="anchor" href="#arg-epsilon"></a></dt>
<dd><p>The half-width of the central difference used to numerically
calculate the derivate when the <code>"etaslope"</code> association structure
is used.</p></dd>


<dt id="arg-basehaz">basehaz<a class="anchor" aria-label="anchor" href="#arg-basehaz"></a></dt>
<dd><p>A character string indicating which baseline hazard to use
for the event submodel. Options are a B-splines approximation estimated
for the log baseline hazard (<code>"bs"</code>, the default), a Weibull
baseline hazard (<code>"weibull"</code>), or a piecewise
constant baseline hazard (<code>"piecewise"</code>). (Note however that there
is currently limited post-estimation functionality available for
models estimated using a piecewise constant baseline hazard).</p></dd>


<dt id="arg-basehaz-ops">basehaz_ops<a class="anchor" aria-label="anchor" href="#arg-basehaz-ops"></a></dt>
<dd><p>A named list specifying options related to the baseline
hazard. Currently this can include: <br></p><dl><dt><code>df</code></dt>
<dd><p>A positive integer specifying the degrees of freedom
  for the B-splines if <code>basehaz = "bs"</code>, or the number of
  intervals used for the piecewise constant baseline hazard if
  <code>basehaz = "piecewise"</code>. The default is 6.</p></dd>

  <dt><code>knots</code></dt>
<dd><p>An optional numeric vector specifying the internal knot
  locations for the B-splines if <code>basehaz = "bs"</code>, or the
  internal cut-points for defining intervals of the piecewise constant
  baseline hazard if <code>basehaz = "piecewise"</code>. Knots cannot be
  specified if <code>df</code> is specified. If not specified, then the
  default is to use <code>df - 4</code> knots if <code>basehaz = "bs"</code>,
  or <code>df - 1</code> knots if <code>basehaz = "piecewise"</code>, which are
  placed at equally spaced percentiles of the distribution of
  observed event times.</p></dd>


</dl></dd>


<dt id="arg-qnodes">qnodes<a class="anchor" aria-label="anchor" href="#arg-qnodes"></a></dt>
<dd><p>The number of nodes to use for the Gauss-Kronrod quadrature
that is used to evaluate the cumulative hazard in the likelihood function.
Options are 15 (the default), 11 or 7.</p></dd>


<dt id="arg-init">init<a class="anchor" aria-label="anchor" href="#arg-init"></a></dt>
<dd><p>The method for generating the initial values for the MCMC.
The default is <code>"prefit"</code>, which uses those obtained from
fitting separate longitudinal and time-to-event models prior to
fitting the joint model. The separate longitudinal model is a
(possibly multivariate) generalised linear mixed
model estimated using variational bayes. This is achieved via the
<code><a href="stan_mvmer.html">stan_mvmer</a></code> function with <code>algorithm = "meanfield"</code>.
The separate Cox model is estimated using <code><a href="https://rdrr.io/pkg/survival/man/coxph.html" class="external-link">coxph</a></code>.
This is achieved
using the and time-to-event models prior
to fitting the joint model. The separate models are estimated using the
<code><a href="https://rdrr.io/pkg/lme4/man/glmer.html" class="external-link">glmer</a></code> and <code><a href="https://rdrr.io/pkg/survival/man/coxph.html" class="external-link">coxph</a></code> functions.
This should provide reasonable initial values which should aid the
MCMC sampler. Parameters that cannot be obtained from
fitting separate longitudinal and time-to-event models are initialised
using the "random" method for <code><a href="https://mc-stan.org/rstan/reference/stan.html" class="external-link">stan</a></code>.
However it is recommended that any final analysis should ideally
be performed with several MCMC chains each initiated from a different
set of initial values; this can be obtained by setting
<code>init = "random"</code>. In addition, other possibilities for specifying
<code>init</code> are the same as those described for <code><a href="https://mc-stan.org/rstan/reference/stan.html" class="external-link">stan</a></code>.</p></dd>


<dt id="arg-weights">weights<a class="anchor" aria-label="anchor" href="#arg-weights"></a></dt>
<dd><p>Experimental and should be used with caution. The
user can optionally supply a 2-column data frame containing a set of
'prior weights' to be used in the estimation process. The data frame should
contain two columns: the first containing the IDs for each individual, and
the second containing the corresponding weights. The data frame should only
have one row for each individual; that is, weights should be constant
within individuals.</p></dd>


<dt id="arg-priorlong-priorevent-priorevent-assoc">priorLong, priorEvent, priorEvent_assoc<a class="anchor" aria-label="anchor" href="#arg-priorlong-priorevent-priorevent-assoc"></a></dt>
<dd><p>The prior distributions for the
regression coefficients in the longitudinal submodel(s), event submodel,
and the association parameter(s). Can be a call to one of the various functions
provided by <span class="pkg">rstanarm</span> for specifying priors. The subset of these functions
that can be used for the prior on the coefficients can be grouped into several
"families":</p>
<table class="table table"><tr><td><strong>Family</strong></td><td><strong>Functions</strong></td></tr><tr><td><em>Student t family</em></td><td><code>normal</code>, <code>student_t</code>, <code>cauchy</code></td></tr><tr><td><em>Hierarchical shrinkage family</em></td><td><code>hs</code>, <code>hs_plus</code></td></tr><tr><td><em>Laplace family</em></td><td><code>laplace</code>, <code>lasso</code></td></tr></table><p>See the <a href="priors.html">priors help page</a> for details on the families and
how to specify the arguments for all of the functions in the table above.
To omit a prior —i.e., to use a flat (improper) uniform prior—
<code>prior</code> can be set to <code>NULL</code>, although this is rarely a good
idea.</p>
<p><strong>Note:</strong> Unless <code>QR=TRUE</code>, if <code>prior</code> is from the Student t
family or Laplace family, and if the <code>autoscale</code> argument to the
function used to specify the prior (e.g. <code><a href="priors.html">normal</a></code>) is left at
its default and recommended value of <code>TRUE</code>, then the default or
user-specified prior scale(s) may be adjusted internally based on the scales
of the predictors. See the <a href="priors.html">priors help page</a> for details on
the rescaling and the <code><a href="prior_summary.stanreg.html">prior_summary</a></code> function for a summary of
the priors used for a particular model.</p></dd>


<dt id="arg-priorlong-intercept-priorevent-intercept">priorLong_intercept, priorEvent_intercept<a class="anchor" aria-label="anchor" href="#arg-priorlong-intercept-priorevent-intercept"></a></dt>
<dd><p>The prior distributions
for the intercepts in the longitudinal submodel(s) and event submodel.
Can be a call to <code>normal</code>, <code>student_t</code> or
<code>cauchy</code>. See the <a href="priors.html">priors help page</a> for details on
these functions. To omit a prior on the intercept —i.e., to use a flat
(improper) uniform prior— <code>prior_intercept</code> can be set to
<code>NULL</code>.</p>
<p><strong>Note:</strong> The prior distribution for the intercept is set so it
applies to the value when all predictors are centered. Moreover,
note that a prior is only placed on the intercept for the event submodel
when a Weibull baseline hazard has been specified. For the B-splines and
piecewise constant baseline hazards there is not intercept parameter that
is given a prior distribution; an intercept parameter will be shown in
the output for the fitted model, but this just corresponds to the
necessary post-estimation adjustment in the linear predictor due to the
centering of the predictiors in the event submodel.</p></dd>


<dt id="arg-priorlong-aux">priorLong_aux<a class="anchor" aria-label="anchor" href="#arg-priorlong-aux"></a></dt>
<dd><p>The prior distribution for the "auxiliary" parameters
in the longitudinal submodels (if applicable).
The "auxiliary" parameter refers to a different parameter
depending on the <code>family</code>. For Gaussian models <code>priorLong_aux</code>
controls <code>"sigma"</code>, the error
standard deviation. For negative binomial models <code>priorLong_aux</code> controls
<code>"reciprocal_dispersion"</code>, which is similar to the
<code>"size"</code> parameter of <code><a href="https://rdrr.io/r/stats/NegBinomial.html" class="external-link">rnbinom</a></code>:
smaller values of <code>"reciprocal_dispersion"</code> correspond to
greater dispersion. For gamma models <code>priorLong_aux</code> sets the prior on
to the <code>"shape"</code> parameter (see e.g.,
<code><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">rgamma</a></code>), and for inverse-Gaussian models it is the
so-called <code>"lambda"</code> parameter (which is essentially the reciprocal of
a scale parameter). Binomial and Poisson models do not have auxiliary
parameters.</p>
<p><code>priorLong_aux</code> can be a call to <code>exponential</code> to
use an exponential distribution, or <code>normal</code>, <code>student_t</code> or
<code>cauchy</code>, which results in a half-normal, half-t, or half-Cauchy
prior. See <code><a href="priors.html">priors</a></code> for details on these functions. To omit a
prior —i.e., to use a flat (improper) uniform prior— set
<code>priorLong_aux</code> to <code>NULL</code>.</p>
<p>If fitting a multivariate joint model, you have the option to
specify a list of prior distributions, however the elements of the list
that correspond to any longitudinal submodel which does not have an
auxiliary parameter will be ignored.</p></dd>


<dt id="arg-priorevent-aux">priorEvent_aux<a class="anchor" aria-label="anchor" href="#arg-priorevent-aux"></a></dt>
<dd><p>The prior distribution for the "auxiliary" parameters
in the event submodel. The "auxiliary" parameters refers to different
parameters depending on the baseline hazard. For <code>basehaz = "weibull"</code>
the auxiliary parameter is the Weibull shape parameter. For
<code>basehaz = "bs"</code> the auxiliary parameters are the coefficients for the
B-spline approximation to the log baseline hazard.
For <code>basehaz = "piecewise"</code> the auxiliary parameters are the piecewise
estimates of the log baseline hazard.</p></dd>


<dt id="arg-prior-covariance">prior_covariance<a class="anchor" aria-label="anchor" href="#arg-prior-covariance"></a></dt>
<dd><p>Cannot be <code>NULL</code>; see <code><a href="priors.html">priors</a></code> for
more information about the prior distributions on covariance matrices.
Note however that the default prior for covariance matrices in
<code>stan_jm</code> is slightly different to that in <code><a href="stan_glmer.html">stan_glmer</a></code>
(the details of which are described on the <code><a href="priors.html">priors</a></code> page).</p></dd>


<dt id="arg-prior-pd">prior_PD<a class="anchor" aria-label="anchor" href="#arg-prior-pd"></a></dt>
<dd><p>A logical scalar (defaulting to <code>FALSE</code>) indicating
whether to draw from the prior predictive distribution instead of
conditioning on the outcome.</p></dd>


<dt id="arg-algorithm">algorithm<a class="anchor" aria-label="anchor" href="#arg-algorithm"></a></dt>
<dd><p>A string (possibly abbreviated) indicating the
estimation approach to use. Can be <code>"sampling"</code> for MCMC (the
default), <code>"optimizing"</code> for optimization, <code>"meanfield"</code> for
variational inference with independent normal distributions, or
<code>"fullrank"</code> for variational inference with a multivariate normal
distribution. See <code><a href="rstanarm-package.html">rstanarm-package</a></code> for more details on the
estimation algorithms. NOTE: not all fitting functions support all four
algorithms.</p></dd>


<dt id="arg-adapt-delta">adapt_delta<a class="anchor" aria-label="anchor" href="#arg-adapt-delta"></a></dt>
<dd><p>Only relevant if <code>algorithm="sampling"</code>. See
the <a href="adapt_delta.html">adapt_delta</a> help page for details.</p></dd>


<dt id="arg-max-treedepth">max_treedepth<a class="anchor" aria-label="anchor" href="#arg-max-treedepth"></a></dt>
<dd><p>A positive integer specifying the maximum treedepth
for the non-U-turn sampler. See the <code>control</code> argument in
<code><a href="https://mc-stan.org/rstan/reference/stan.html" class="external-link">stan</a></code>.</p></dd>


<dt id="arg-qr">QR<a class="anchor" aria-label="anchor" href="#arg-qr"></a></dt>
<dd><p>A logical scalar defaulting to <code>FALSE</code>, but if <code>TRUE</code>
applies a scaled <code><a href="https://rdrr.io/r/base/qr.html" class="external-link">qr</a></code> decomposition to the design matrix. The
transformation does not change the likelihood of the data but is
recommended for computational reasons when there are multiple predictors.
See the <a href="QR-argument.html">QR-argument</a> documentation page for details on how
<span class="pkg">rstanarm</span> does the transformation and important information about how
to interpret the prior distributions of the model parameters when using
<code>QR=TRUE</code>.</p></dd>


<dt id="arg-sparse">sparse<a class="anchor" aria-label="anchor" href="#arg-sparse"></a></dt>
<dd><p>A logical scalar (defaulting to <code>FALSE</code>) indicating
whether to use a sparse representation of the design (X) matrix.
If <code>TRUE</code>, the the design matrix is not centered (since that would
destroy the sparsity) and likewise it is not possible to specify both
<code>QR = TRUE</code> and <code>sparse = TRUE</code>. Depending on how many zeros
there are in the design matrix, setting <code>sparse = TRUE</code> may make
the code run faster and can consume much less RAM.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Further arguments passed to the function in the <span class="pkg">rstan</span>
package (<code>sampling</code>,
<code>vb</code>, or
<code>optimizing</code>),
corresponding to the estimation method named by <code>algorithm</code>. For example,
if <code>algorithm</code> is <code>"sampling"</code> it is possible to specify <code>iter</code>,
<code>chains</code>, <code>cores</code>, and other MCMC controls.</p>
<p>Another useful argument that can be passed to <span class="pkg">rstan</span> via <code>...</code> is
<code>refresh</code>, which specifies how often to print updates when sampling
(i.e., show the progress every <code>refresh</code> iterations). <code>refresh=0</code>
turns off the iteration updates.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <a href="stanreg-objects.html">stanjm</a> object is returned.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The <code>stan_jm</code> function can be used to fit a joint model (also
  known as a shared parameter model) for longitudinal and time-to-event data
  under a Bayesian framework. The underlying
  estimation is carried out using the Bayesian C++ package Stan
  (<a href="https://mc-stan.org/" class="external-link">https://mc-stan.org/</a>). <br><br>
  The joint model may be univariate (with only one longitudinal submodel) or
  multivariate (with more than one longitudinal submodel).
  For the longitudinal submodel a (possibly multivariate) generalised linear
  mixed model is assumed with any of the <code><a href="https://rdrr.io/r/stats/family.html" class="external-link">family</a></code> choices
  allowed by <code><a href="https://rdrr.io/pkg/lme4/man/glmer.html" class="external-link">glmer</a></code>. If a multivariate joint model is specified
  (by providing a list of formulas in the <code>formulaLong</code> argument), then
  the multivariate longitudinal submodel consists of a multivariate generalized
  linear model (GLM) with group-specific terms that are assumed to be correlated
  across the different GLM submodels. That is, within
  a grouping factor (for example, patient ID) the group-specific terms are
  assumed to be correlated across the different GLM submodels. It is
  possible to specify a different outcome type (for example a different
  family and/or link function) for each of the GLM submodels, by providing
  a list of <code><a href="https://rdrr.io/r/stats/family.html" class="external-link">family</a></code> objects in the <code>family</code>
  argument. Multi-level
  clustered data are allowed, and that additional clustering can occur at a
  level higher than the individual-level (e.g. patients clustered within
  clinics), or at a level lower than the individual-level (e.g. tumor lesions
  clustered within patients). If the clustering occurs at a level lower than
  the individual, then the user needs to indicate how the lower level
  clusters should be handled when forming the association structure between
  the longitudinal and event submodels (see the <code>grp_assoc</code> argument
  described above). <br><br>
  For the event submodel a parametric
  proportional hazards model is assumed. The baseline hazard can be estimated
  using either a cubic B-splines approximation (<code>basehaz = "bs"</code>, the
  default), a Weibull distribution (<code>basehaz = "weibull"</code>), or a
  piecewise constant baseline hazard (<code>basehaz = "piecewise"</code>).
  If the B-spline or piecewise constant baseline hazards are used,
  then the degrees of freedom or the internal knot locations can be
  (optionally) specified. If
  the degrees of freedom are specified (through the <code>df</code> argument) then
  the knot locations are automatically generated based on the
  distribution of the observed event times (not including censoring times).
  Otherwise internal knot locations can be specified
  directly through the <code>knots</code> argument. If neither <code>df</code> or
  <code>knots</code> is specified, then the default is to set <code>df</code> equal to 6.
  It is not possible to specify both <code>df</code> and <code>knots</code>. <br><br>
  Time-varying covariates are allowed in both the
  longitudinal and event submodels. These should be specified in the data
  in the same way as they normally would when fitting a separate
  longitudinal model using <code><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lmer</a></code> or a separate
  time-to-event model using <code><a href="https://rdrr.io/pkg/survival/man/coxph.html" class="external-link">coxph</a></code>. These time-varying
  covariates should be exogenous in nature, otherwise they would perhaps
  be better specified as an additional outcome (i.e. by including them as an
  additional longitudinal outcome in the joint model). <br><br>
  Bayesian estimation of the joint model is performed via MCMC. The Bayesian
  model includes independent priors on the
  regression coefficients for both the longitudinal and event submodels,
  including the association parameter(s) (in much the same way as the
  regression parameters in <code><a href="stan_glm.html">stan_glm</a></code>) and
  priors on the terms of a decomposition of the covariance matrices of the
  group-specific parameters.
  See <code><a href="priors.html">priors</a></code> for more information about the priors distributions
  that are available. <br><br>
  Gauss-Kronrod quadrature is used to numerically evaluate the integral
  over the cumulative hazard in the likelihood function for the event submodel.
  The accuracy of the numerical approximation can be controlled using the
  number of quadrature nodes, specified through the <code>qnodes</code>
  argument. Using a higher number of quadrature nodes will result in a more
  accurate approximation.</p>
<p></p><div class="section">
<h3 id="association-structures">Association structures<a class="anchor" aria-label="anchor" href="#association-structures"></a></h3>
<p>The association structure for the joint model can be based on any of the
  following parameterisations:</p><ul><li><p>current value of the linear predictor in the
        longitudinal submodel (<code>"etavalue"</code>)</p></li>
<li><p>first derivative (slope) of the linear predictor in the
        longitudinal submodel (<code>"etaslope"</code>)</p></li>
<li><p>the area under the curve of the linear predictor in the
        longitudinal submodel (<code>"etaauc"</code>)</p></li>
<li><p>current expected value of the longitudinal submodel
        (<code>"muvalue"</code>)</p></li>
<li><p>the area under the curve of the expected value from the
        longitudinal submodel (<code>"muauc"</code>)</p></li>
<li><p>shared individual-level random effects (<code>"shared_b"</code>)</p></li>
<li><p>shared individual-level random effects which also incorporate
        the corresponding fixed effect as well as any corresponding
        random effects for clustering levels higher than the individual)
        (<code>"shared_coef"</code>)</p></li>
<li><p>interactions between association terms and observed data/covariates
        (<code>"etavalue_data"</code>, <code>"etaslope_data"</code>, <code>"muvalue_data"</code>,
        <code>"muslope_data"</code>). These are described further below.</p></li>
<li><p>interactions between association terms corresponding to different
        longitudinal outcomes in a multivariate joint model
        (<code>"etavalue_etavalue(#)"</code>, <code>"etavalue_muvalue(#)"</code>,
        <code>"muvalue_etavalue(#)"</code>, <code>"muvalue_muvalue(#)"</code>). These
        are described further below.</p></li>
<li><p>no association structure (equivalent to fitting separate
        longitudinal and event models) (<code>"null"</code> or <code>NULL</code>)</p></li>
</ul><p>More than one association structure can be specified, however,
  not all possible combinations are allowed.
  Note that for the lagged association structures baseline values (time = 0)
  are used for the instances
  where the time lag results in a time prior to baseline. When using the
  <code>"etaauc"</code> or <code>"muauc"</code> association structures, the area under
  the curve is evaluated using Gauss-Kronrod quadrature with 15 quadrature
  nodes. By default, <code>"shared_b"</code> and <code>"shared_coef"</code> contribute
  all random effects to the association structure; however, a subset of the
  random effects can be chosen by specifying their indices between parentheses
  as a suffix, for example, <code>"shared_b(1)"</code> or <code>"shared_b(1:3)"</code> or
  <code>"shared_b(1,2,4)"</code>, and so on. <br><br>
  In addition, several association terms (<code>"etavalue"</code>, <code>"etaslope"</code>,
  <code>"muvalue"</code>, <code>"muslope"</code>) can be interacted with observed
  data/covariates. To do this, use the association term's main handle plus a
  suffix of <code>"_data"</code> then followed by the model matrix formula in
  parentheses. For example if we had a variable in our dataset for gender
  named <code>sex</code> then we might want to obtain different estimates for the
  association between the current slope of the marker and the risk of the
  event for each gender. To do this we would specify
  <code>assoc = c("etaslope", "etaslope_data(~ sex)")</code>. <br><br>
  It is also possible, when fitting  a multivariate joint model, to include
  interaction terms between the association terms themselves (this only
  applies for interacting <code>"etavalue"</code> or <code>"muvalue"</code>). For example,
  if we had a joint model with two longitudinal markers, we could specify
  <code>assoc = list(c("etavalue", "etavalue_etavalue(2)"), "etavalue")</code>.
  The first element of list says we want to use the value of the linear
  predictor for the first marker, as well as it's interaction with the
  value of the linear predictor for the second marker. The second element of
  the list says we want to also include the expected value of the second marker
  (i.e. as a "main effect"). Therefore, the linear predictor for the event
  submodel would include the "main effects" for each marker as well as their
  interaction. <br><br>
  There are additional examples in the <strong>Examples</strong> section below.</p>
</div>

    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="stanreg-objects.html">stanreg-objects</a></code>, <code><a href="stanmvreg-methods.html">stanmvreg-methods</a></code>,
  <code><a href="print.stanreg.html">print.stanmvreg</a></code>, <code><a href="summary.stanreg.html">summary.stanmvreg</a></code>,
  <code><a href="posterior_traj.html">posterior_traj</a></code>, <code><a href="posterior_survfit.html">posterior_survfit</a></code>,
  <code><a href="posterior_predict.stanreg.html">posterior_predict</a></code>, <code><a href="posterior_interval.stanreg.html">posterior_interval</a></code>,
  <code><a href="pp_check.stanreg.html">pp_check</a></code>, <code><a href="ps_check.html">ps_check</a></code>, <code><a href="stan_mvmer.html">stan_mvmer</a></code>.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="va">.Platform</span><span class="op">$</span><span class="va">OS.type</span> <span class="op">!=</span> <span class="st">"windows"</span> <span class="op">||</span> <span class="va">.Platform</span><span class="op">$</span><span class="va">r_arch</span> <span class="op">!=</span><span class="st">"i386"</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#####</span></span></span>
<span class="r-in"><span><span class="co"># Univariate joint model, with association structure based on the </span></span></span>
<span class="r-in"><span><span class="co"># current value of the linear predictor</span></span></span>
<span class="r-in"><span><span class="va">f1</span> <span class="op">&lt;-</span> <span class="fu">stan_jm</span><span class="op">(</span>formulaLong <span class="op">=</span> <span class="va">logBili</span> <span class="op">~</span> <span class="va">year</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>              dataLong <span class="op">=</span> <span class="va">pbcLong</span>,</span></span>
<span class="r-in"><span>              formulaEvent <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">futimeYears</span>, <span class="va">death</span><span class="op">)</span> <span class="op">~</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">trt</span>, </span></span>
<span class="r-in"><span>              dataEvent <span class="op">=</span> <span class="va">pbcSurv</span>,</span></span>
<span class="r-in"><span>              time_var <span class="op">=</span> <span class="st">"year"</span>,</span></span>
<span class="r-in"><span>              <span class="co"># this next line is only to keep the example small in size!</span></span></span>
<span class="r-in"><span>              chains <span class="op">=</span> <span class="fl">1</span>, cores <span class="op">=</span> <span class="fl">1</span>, seed <span class="op">=</span> <span class="fl">12345</span>, iter <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">f1</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">f1</span><span class="op">)</span> </span></span>
<span class="r-in"><span>        </span></span>
<span class="r-in"><span><span class="co">#####</span></span></span>
<span class="r-in"><span><span class="co"># Univariate joint model, with association structure based on the </span></span></span>
<span class="r-in"><span><span class="co"># current value and slope of the linear predictor</span></span></span>
<span class="r-in"><span><span class="va">f2</span> <span class="op">&lt;-</span> <span class="fu">stan_jm</span><span class="op">(</span>formulaLong <span class="op">=</span> <span class="va">logBili</span> <span class="op">~</span> <span class="va">year</span> <span class="op">+</span> <span class="op">(</span><span class="va">year</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>              dataLong <span class="op">=</span> <span class="va">pbcLong</span>,</span></span>
<span class="r-in"><span>              formulaEvent <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">futimeYears</span>, <span class="va">death</span><span class="op">)</span> <span class="op">~</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">trt</span>, </span></span>
<span class="r-in"><span>              dataEvent <span class="op">=</span> <span class="va">pbcSurv</span>,</span></span>
<span class="r-in"><span>              assoc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"etavalue"</span>, <span class="st">"etaslope"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>              time_var <span class="op">=</span> <span class="st">"year"</span>,</span></span>
<span class="r-in"><span>              chains <span class="op">=</span> <span class="fl">1</span>, cores <span class="op">=</span> <span class="fl">1</span>, seed <span class="op">=</span> <span class="fl">12345</span>, iter <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">f2</span><span class="op">)</span>  </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#####</span></span></span>
<span class="r-in"><span><span class="co"># Univariate joint model, with association structure based on the </span></span></span>
<span class="r-in"><span><span class="co"># lagged value of the linear predictor, where the lag is 2 time </span></span></span>
<span class="r-in"><span><span class="co"># units (i.e. 2 years in this example)</span></span></span>
<span class="r-in"><span><span class="va">f3</span> <span class="op">&lt;-</span> <span class="fu">stan_jm</span><span class="op">(</span>formulaLong <span class="op">=</span> <span class="va">logBili</span> <span class="op">~</span> <span class="va">year</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>              dataLong <span class="op">=</span> <span class="va">pbcLong</span>,</span></span>
<span class="r-in"><span>              formulaEvent <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">futimeYears</span>, <span class="va">death</span><span class="op">)</span> <span class="op">~</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">trt</span>, </span></span>
<span class="r-in"><span>              dataEvent <span class="op">=</span> <span class="va">pbcSurv</span>,</span></span>
<span class="r-in"><span>              time_var <span class="op">=</span> <span class="st">"year"</span>,</span></span>
<span class="r-in"><span>              assoc <span class="op">=</span> <span class="st">"etavalue"</span>, lag_assoc <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>              chains <span class="op">=</span> <span class="fl">1</span>, cores <span class="op">=</span> <span class="fl">1</span>, seed <span class="op">=</span> <span class="fl">12345</span>, iter <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">f3</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#####</span></span></span>
<span class="r-in"><span><span class="co"># Univariate joint model, where the association structure includes </span></span></span>
<span class="r-in"><span><span class="co"># interactions with observed data. Here we specify that we want to use </span></span></span>
<span class="r-in"><span><span class="co"># an association structure based on the current value of the linear </span></span></span>
<span class="r-in"><span><span class="co"># predictor from the longitudinal submodel (i.e. "etavalue"), but we </span></span></span>
<span class="r-in"><span><span class="co"># also want to interact this with the treatment covariate (trt) from</span></span></span>
<span class="r-in"><span><span class="co"># pbcLong data frame, so that we can estimate a different association </span></span></span>
<span class="r-in"><span><span class="co"># parameter (i.e. estimated effect of log serum bilirubin on the log </span></span></span>
<span class="r-in"><span><span class="co"># hazard of death) for each treatment group</span></span></span>
<span class="r-in"><span><span class="va">f4</span> <span class="op">&lt;-</span> <span class="fu">stan_jm</span><span class="op">(</span>formulaLong <span class="op">=</span> <span class="va">logBili</span> <span class="op">~</span> <span class="va">year</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>              dataLong <span class="op">=</span> <span class="va">pbcLong</span>,</span></span>
<span class="r-in"><span>              formulaEvent <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">futimeYears</span>, <span class="va">death</span><span class="op">)</span> <span class="op">~</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">trt</span>, </span></span>
<span class="r-in"><span>              dataEvent <span class="op">=</span> <span class="va">pbcSurv</span>,</span></span>
<span class="r-in"><span>              time_var <span class="op">=</span> <span class="st">"year"</span>,</span></span>
<span class="r-in"><span>              assoc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"etavalue"</span>, <span class="st">"etavalue_data(~ trt)"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>              chains <span class="op">=</span> <span class="fl">1</span>, cores <span class="op">=</span> <span class="fl">1</span>, seed <span class="op">=</span> <span class="fl">12345</span>, iter <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">f4</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">######</span></span></span>
<span class="r-in"><span><span class="co"># Multivariate joint model, with association structure based </span></span></span>
<span class="r-in"><span><span class="co"># on the current value and slope of the linear predictor in the </span></span></span>
<span class="r-in"><span><span class="co"># first longitudinal submodel and the area under the marker </span></span></span>
<span class="r-in"><span><span class="co"># trajectory for the second longitudinal submodel</span></span></span>
<span class="r-in"><span><span class="va">mv1</span> <span class="op">&lt;-</span> <span class="fu">stan_jm</span><span class="op">(</span></span></span>
<span class="r-in"><span>        formulaLong <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>          <span class="va">logBili</span> <span class="op">~</span> <span class="va">year</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>          <span class="va">albumin</span> <span class="op">~</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">year</span> <span class="op">+</span> <span class="op">(</span><span class="va">year</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        dataLong <span class="op">=</span> <span class="va">pbcLong</span>,</span></span>
<span class="r-in"><span>        formulaEvent <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">futimeYears</span>, <span class="va">death</span><span class="op">)</span> <span class="op">~</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">trt</span>, </span></span>
<span class="r-in"><span>        dataEvent <span class="op">=</span> <span class="va">pbcSurv</span>,</span></span>
<span class="r-in"><span>        assoc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"etavalue"</span>, <span class="st">"etaslope"</span><span class="op">)</span>, <span class="st">"etaauc"</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>        time_var <span class="op">=</span> <span class="st">"year"</span>,</span></span>
<span class="r-in"><span>        chains <span class="op">=</span> <span class="fl">1</span>, cores <span class="op">=</span> <span class="fl">1</span>, seed <span class="op">=</span> <span class="fl">12345</span>, iter <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">mv1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#####</span></span></span>
<span class="r-in"><span><span class="co"># Multivariate joint model, where the association structure is formed by </span></span></span>
<span class="r-in"><span><span class="co"># including the expected value of each longitudinal marker (logBili and </span></span></span>
<span class="r-in"><span><span class="co"># albumin) in the linear predictor of the event submodel, as well as their </span></span></span>
<span class="r-in"><span><span class="co"># interaction effect (i.e. the interaction between the two "etavalue" terms). </span></span></span>
<span class="r-in"><span><span class="co"># Note that whether such an association structure based on a marker by </span></span></span>
<span class="r-in"><span><span class="co"># marker interaction term makes sense will depend on the context of your </span></span></span>
<span class="r-in"><span><span class="co"># application -- here we just show it for demostration purposes).</span></span></span>
<span class="r-in"><span><span class="va">mv2</span> <span class="op">&lt;-</span> <span class="fu">stan_jm</span><span class="op">(</span></span></span>
<span class="r-in"><span>        formulaLong <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>          <span class="va">logBili</span> <span class="op">~</span> <span class="va">year</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>          <span class="va">albumin</span> <span class="op">~</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">year</span> <span class="op">+</span> <span class="op">(</span><span class="va">year</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        dataLong <span class="op">=</span> <span class="va">pbcLong</span>,</span></span>
<span class="r-in"><span>        formulaEvent <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">futimeYears</span>, <span class="va">death</span><span class="op">)</span> <span class="op">~</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">trt</span>, </span></span>
<span class="r-in"><span>        dataEvent <span class="op">=</span> <span class="va">pbcSurv</span>,</span></span>
<span class="r-in"><span>        assoc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"etavalue"</span>, <span class="st">"etavalue_etavalue(2)"</span><span class="op">)</span>, <span class="st">"etavalue"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        time_var <span class="op">=</span> <span class="st">"year"</span>, </span></span>
<span class="r-in"><span>        chains <span class="op">=</span> <span class="fl">1</span>, cores <span class="op">=</span> <span class="fl">1</span>, seed <span class="op">=</span> <span class="fl">12345</span>, iter <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span>        </span></span>
<span class="r-in"><span><span class="co">#####</span></span></span>
<span class="r-in"><span><span class="co"># Multivariate joint model, with one bernoulli marker and one</span></span></span>
<span class="r-in"><span><span class="co"># Gaussian marker. We will artificially create the bernoulli</span></span></span>
<span class="r-in"><span><span class="co"># marker by dichotomising log serum bilirubin</span></span></span>
<span class="r-in"><span><span class="va">pbcLong</span><span class="op">$</span><span class="va">ybern</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">pbcLong</span><span class="op">$</span><span class="va">logBili</span> <span class="op">&gt;=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">pbcLong</span><span class="op">$</span><span class="va">logBili</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mv3</span> <span class="op">&lt;-</span> <span class="fu">stan_jm</span><span class="op">(</span></span></span>
<span class="r-in"><span>        formulaLong <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>          <span class="va">ybern</span> <span class="op">~</span> <span class="va">year</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>          <span class="va">albumin</span> <span class="op">~</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">year</span> <span class="op">+</span> <span class="op">(</span><span class="va">year</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        dataLong <span class="op">=</span> <span class="va">pbcLong</span>,</span></span>
<span class="r-in"><span>        formulaEvent <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">futimeYears</span>, <span class="va">death</span><span class="op">)</span> <span class="op">~</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">trt</span>, </span></span>
<span class="r-in"><span>        dataEvent <span class="op">=</span> <span class="va">pbcSurv</span>,</span></span>
<span class="r-in"><span>        family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">binomial</span>, <span class="va">gaussian</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        time_var <span class="op">=</span> <span class="st">"year"</span>, </span></span>
<span class="r-in"><span>        chains <span class="op">=</span> <span class="fl">1</span>, cores <span class="op">=</span> <span class="fl">1</span>, seed <span class="op">=</span> <span class="fl">12345</span>, iter <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitting a univariate joint model.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Please note the warmup may be much slower than later iterations!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SAMPLING FOR MODEL 'jm' NOW (CHAIN 1).</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Gradient evaluation took 0.000163 seconds</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 1.63 seconds.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Adjust your expectations accordingly!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration:   1 / 1000 [  0%]  (Warmup)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 100 / 1000 [ 10%]  (Warmup)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 200 / 1000 [ 20%]  (Warmup)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 300 / 1000 [ 30%]  (Warmup)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 400 / 1000 [ 40%]  (Warmup)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 500 / 1000 [ 50%]  (Warmup)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 501 / 1000 [ 50%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 600 / 1000 [ 60%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 700 / 1000 [ 70%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 800 / 1000 [ 80%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 900 / 1000 [ 90%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 1000 / 1000 [100%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1:  Elapsed Time: 3.219 seconds (Warm-up)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1:                2.192 seconds (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1:                5.411 seconds (Total)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: </span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Bulk Effective Samples Size (ESS) is too low, indicating posterior means and medians may be unreliable.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> Running the chains for more iterations may help. See</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> https://mc-stan.org/misc/warnings.html#bulk-ess</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Tail Effective Samples Size (ESS) is too low, indicating posterior variances and tail quantiles may be unreliable.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> Running the chains for more iterations may help. See</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> https://mc-stan.org/misc/warnings.html#tail-ess</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> stan_jm</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  formula (Long1): logBili ~ year + (1 | id)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  family  (Long1): gaussian [identity]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  formula (Event): Surv(futimeYears, death) ~ sex + trt</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  baseline hazard: bs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  assoc:           etavalue (Long1)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Longitudinal submodel: logBili</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Median MAD_SD</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept) 0.802  0.203 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> year        0.092  0.010 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sigma       0.509  0.026 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Event submodel:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 Median MAD_SD exp(Median)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)     -3.068  0.569  0.046     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sexf            -0.376  0.538  0.687     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> trt             -0.719  0.506  0.487     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Long1|etavalue   1.449  0.281  4.257     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b-splines-coef1 -1.418  1.106     NA     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b-splines-coef2  0.222  0.859     NA     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b-splines-coef3 -1.768  1.192     NA     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b-splines-coef4  1.058  1.450     NA     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b-splines-coef5 -0.460  1.602     NA     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b-splines-coef6 -0.369  1.558     NA     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Group-level error terms:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Groups Name              Std.Dev.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  id     Long1|(Intercept) 1.323   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Num. levels: id 40 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sample avg. posterior predictive distribution </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> of longitudinal outcomes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                Median MAD_SD</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Long1|mean_PPD 0.586  0.043 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> For info on the priors used see help('prior_summary.stanreg').Fitting a univariate joint model.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Please note the warmup may be much slower than later iterations!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SAMPLING FOR MODEL 'jm' NOW (CHAIN 1).</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Gradient evaluation took 0.000281 seconds</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 2.81 seconds.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Adjust your expectations accordingly!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration:   1 / 1000 [  0%]  (Warmup)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 100 / 1000 [ 10%]  (Warmup)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 200 / 1000 [ 20%]  (Warmup)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 300 / 1000 [ 30%]  (Warmup)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 400 / 1000 [ 40%]  (Warmup)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 500 / 1000 [ 50%]  (Warmup)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 501 / 1000 [ 50%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 600 / 1000 [ 60%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 700 / 1000 [ 70%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 800 / 1000 [ 80%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 900 / 1000 [ 90%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 1000 / 1000 [100%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1:  Elapsed Time: 21.061 seconds (Warm-up)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1:                15 seconds (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1:                36.061 seconds (Total)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: </span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Bulk Effective Samples Size (ESS) is too low, indicating posterior means and medians may be unreliable.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> Running the chains for more iterations may help. See</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> https://mc-stan.org/misc/warnings.html#bulk-ess</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Tail Effective Samples Size (ESS) is too low, indicating posterior variances and tail quantiles may be unreliable.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> Running the chains for more iterations may help. See</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> https://mc-stan.org/misc/warnings.html#tail-ess</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> stan_jm</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  formula (Long1): logBili ~ year + (year | id)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  family  (Long1): gaussian [identity]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  formula (Event): Surv(futimeYears, death) ~ sex + trt</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  baseline hazard: bs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  assoc:           etavalue (Long1), etaslope (Long1)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Longitudinal submodel: logBili</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Median MAD_SD</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept) 0.625  0.229 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> year        0.249  0.063 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sigma       0.357  0.017 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Event submodel:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 Median    MAD_SD    exp(Median)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)        -3.416     0.757     0.033  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sexf               -0.440     0.720     0.644  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> trt                -0.987     0.640     0.373  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Long1|etavalue      0.821     0.427     2.273  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Long1|etaslope      9.538     5.737 13874.955  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b-splines-coef1    -5.377     4.425        NA  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b-splines-coef2    -2.087     2.338        NA  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b-splines-coef3    -2.848     1.555        NA  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b-splines-coef4    -0.511     1.833        NA  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b-splines-coef5     0.326     1.747        NA  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b-splines-coef6    -0.537     1.694        NA  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Group-level error terms:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Groups Name              Std.Dev. Corr</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  id     Long1|(Intercept) 1.284        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Long1|year        0.241    0.67</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Num. levels: id 40 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sample avg. posterior predictive distribution </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> of longitudinal outcomes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                Median MAD_SD</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Long1|mean_PPD 0.585  0.027 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> For info on the priors used see help('prior_summary.stanreg').Fitting a univariate joint model.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Please note the warmup may be much slower than later iterations!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SAMPLING FOR MODEL 'jm' NOW (CHAIN 1).</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Gradient evaluation took 0.000145 seconds</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 1.45 seconds.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Adjust your expectations accordingly!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration:   1 / 1000 [  0%]  (Warmup)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 100 / 1000 [ 10%]  (Warmup)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 200 / 1000 [ 20%]  (Warmup)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 300 / 1000 [ 30%]  (Warmup)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 400 / 1000 [ 40%]  (Warmup)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 500 / 1000 [ 50%]  (Warmup)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 501 / 1000 [ 50%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 600 / 1000 [ 60%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 700 / 1000 [ 70%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 800 / 1000 [ 80%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 900 / 1000 [ 90%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 1000 / 1000 [100%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1:  Elapsed Time: 2.707 seconds (Warm-up)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1:                2.172 seconds (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1:                4.879 seconds (Total)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: </span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Bulk Effective Samples Size (ESS) is too low, indicating posterior means and medians may be unreliable.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> Running the chains for more iterations may help. See</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> https://mc-stan.org/misc/warnings.html#bulk-ess</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Tail Effective Samples Size (ESS) is too low, indicating posterior variances and tail quantiles may be unreliable.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> Running the chains for more iterations may help. See</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> https://mc-stan.org/misc/warnings.html#tail-ess</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> stan_jm</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  formula (Long1): logBili ~ year + (1 | id)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  family  (Long1): gaussian [identity]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  formula (Event): Surv(futimeYears, death) ~ sex + trt</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  baseline hazard: bs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  assoc:           etavalue (Long1)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Longitudinal submodel: logBili</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Median MAD_SD</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept) 0.838  0.188 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> year        0.092  0.010 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sigma       0.509  0.023 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Event submodel:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 Median MAD_SD exp(Median)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)     -2.910  0.631  0.054     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sexf            -0.380  0.591  0.684     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> trt             -0.703  0.489  0.495     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Long1|etavalue   1.454  0.254  4.281     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b-splines-coef1 -1.600  1.023     NA     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b-splines-coef2  0.250  0.898     NA     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b-splines-coef3 -1.518  1.312     NA     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b-splines-coef4  0.913  1.666     NA     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b-splines-coef5 -0.029  1.747     NA     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b-splines-coef6 -0.174  1.602     NA     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Group-level error terms:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Groups Name              Std.Dev.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  id     Long1|(Intercept) 1.325   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Num. levels: id 40 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sample avg. posterior predictive distribution </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> of longitudinal outcomes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                Median MAD_SD</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Long1|mean_PPD 0.585  0.042 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> For info on the priors used see help('prior_summary.stanreg').Fitting a univariate joint model.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Please note the warmup may be much slower than later iterations!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SAMPLING FOR MODEL 'jm' NOW (CHAIN 1).</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Gradient evaluation took 0.000176 seconds</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 1.76 seconds.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Adjust your expectations accordingly!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration:   1 / 1000 [  0%]  (Warmup)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 100 / 1000 [ 10%]  (Warmup)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 200 / 1000 [ 20%]  (Warmup)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 300 / 1000 [ 30%]  (Warmup)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 400 / 1000 [ 40%]  (Warmup)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 500 / 1000 [ 50%]  (Warmup)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 501 / 1000 [ 50%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 600 / 1000 [ 60%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 700 / 1000 [ 70%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 800 / 1000 [ 80%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 900 / 1000 [ 90%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 1000 / 1000 [100%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1:  Elapsed Time: 3.981 seconds (Warm-up)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1:                2.835 seconds (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1:                6.816 seconds (Total)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: </span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>The largest R-hat is 1.06, indicating chains have not mixed.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> Running the chains for more iterations may help. See</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> https://mc-stan.org/misc/warnings.html#r-hat</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Bulk Effective Samples Size (ESS) is too low, indicating posterior means and medians may be unreliable.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> Running the chains for more iterations may help. See</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> https://mc-stan.org/misc/warnings.html#bulk-ess</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Tail Effective Samples Size (ESS) is too low, indicating posterior variances and tail quantiles may be unreliable.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> Running the chains for more iterations may help. See</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> https://mc-stan.org/misc/warnings.html#tail-ess</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> stan_jm</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  formula (Long1): logBili ~ year + (1 | id)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  family  (Long1): gaussian [identity]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  formula (Event): Surv(futimeYears, death) ~ sex + trt</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  baseline hazard: bs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  assoc:           etavalue (Long1), etavalue_data (Long1)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Longitudinal submodel: logBili</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Median MAD_SD</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept) 0.830  0.206 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> year        0.092  0.008 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sigma       0.508  0.022 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Event submodel:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    Median MAD_SD exp(Median)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)        -3.140  0.690  0.043     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sexf               -0.366  0.629  0.694     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> trt                -0.184  0.929  0.832     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Long1|etavalue      1.598  0.323  4.945     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Long1|etavalue:trt -0.374  0.574  0.688     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b-splines-coef1    -1.477  1.254     NA     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b-splines-coef2     0.038  0.856     NA     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b-splines-coef3    -1.639  1.234     NA     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b-splines-coef4     0.736  1.674     NA     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b-splines-coef5    -0.292  1.705     NA     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b-splines-coef6    -0.227  1.665     NA     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Group-level error terms:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Groups Name              Std.Dev.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  id     Long1|(Intercept) 1.345   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Num. levels: id 40 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sample avg. posterior predictive distribution </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> of longitudinal outcomes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                Median MAD_SD</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Long1|mean_PPD 0.588  0.039 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> For info on the priors used see help('prior_summary.stanreg').Fitting a multivariate joint model.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Please note the warmup may be much slower than later iterations!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SAMPLING FOR MODEL 'jm' NOW (CHAIN 1).</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Rejecting initial value:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1:   Log probability evaluates to log(0), i.e. negative infinity.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1:   Stan can't start sampling from this initial value.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Gradient evaluation took 0.001643 seconds</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 16.43 seconds.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Adjust your expectations accordingly!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: WARNING: There aren't enough warmup iterations to fit the</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1:          three stages of adaptation as currently configured.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1:          Reducing each adaptation stage to 15%/75%/10% of</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1:          the given number of warmup iterations:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1:            init_buffer = 7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1:            adapt_window = 38</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1:            term_buffer = 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration:  1 / 100 [  1%]  (Warmup)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 10 / 100 [ 10%]  (Warmup)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 20 / 100 [ 20%]  (Warmup)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 30 / 100 [ 30%]  (Warmup)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 40 / 100 [ 40%]  (Warmup)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 50 / 100 [ 50%]  (Warmup)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 51 / 100 [ 51%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 60 / 100 [ 60%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 70 / 100 [ 70%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 80 / 100 [ 80%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 90 / 100 [ 90%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 100 / 100 [100%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1:  Elapsed Time: 23.534 seconds (Warm-up)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1:                0.636 seconds (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1:                24.17 seconds (Total)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: </span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>There were 50 divergent transitions after warmup. See</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> https://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> to find out why this is a problem and how to eliminate them.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Examine the pairs() plot to diagnose sampling problems</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>The largest R-hat is 2.15, indicating chains have not mixed.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> Running the chains for more iterations may help. See</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> https://mc-stan.org/misc/warnings.html#r-hat</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Bulk Effective Samples Size (ESS) is too low, indicating posterior means and medians may be unreliable.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> Running the chains for more iterations may help. See</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> https://mc-stan.org/misc/warnings.html#bulk-ess</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Tail Effective Samples Size (ESS) is too low, indicating posterior variances and tail quantiles may be unreliable.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> Running the chains for more iterations may help. See</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> https://mc-stan.org/misc/warnings.html#tail-ess</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Markov chains did not converge! Do not analyze results!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> stan_jm</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  formula (Long1): logBili ~ year + (1 | id)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  family  (Long1): gaussian [identity]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  formula (Long2): albumin ~ sex + year + (year | id)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  family  (Long2): gaussian [identity]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  formula (Event): Surv(futimeYears, death) ~ sex + trt</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  baseline hazard: bs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  assoc:           etavalue (Long1), etaslope (Long1), etaauc (Long2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Longitudinal submodel 1: logBili</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Median MAD_SD</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept) 0.697  0.000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> year        0.086  0.000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sigma       0.526  0.000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Longitudinal submodel 2: albumin</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Median MAD_SD</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)  3.509  0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sexf         0.081  0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> year        -0.123  0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sigma        0.334  0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Event submodel:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 Median        MAD_SD        exp(Median)  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)      1.082885e+11  1.330000e-01           Inf</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sexf            -3.470000e-01  0.000000e+00  7.070000e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> trt             -9.600000e-02  0.000000e+00  9.080000e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Long1|etavalue   3.422000e+00  0.000000e+00  3.064300e+01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Long1|etaslope  -1.264015e+12  1.549000e+00  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Long2|etaauc     3.360000e-01  0.000000e+00  1.399000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b-splines-coef1  0.000000e+00  0.000000e+00            NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b-splines-coef2  0.000000e+00  0.000000e+00            NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b-splines-coef3  0.000000e+00  0.000000e+00            NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b-splines-coef4  0.000000e+00  0.000000e+00            NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b-splines-coef5  0.000000e+00  0.000000e+00            NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b-splines-coef6  0.000000e+00  0.000000e+00            NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Group-level error terms:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Groups Name              Std.Dev. Corr     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  id     Long1|(Intercept) 1.11688           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Long2|(Intercept) 0.36463  0.00     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Long2|year        0.03419  0.00 0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Num. levels: id 40 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sample avg. posterior predictive distribution </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> of longitudinal outcomes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                Median MAD_SD</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Long1|mean_PPD 0.885  0.036 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Long2|mean_PPD 3.145  0.021 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> For info on the priors used see help('prior_summary.stanreg').Fitting a multivariate joint model.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Please note the warmup may be much slower than later iterations!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SAMPLING FOR MODEL 'jm' NOW (CHAIN 1).</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Gradient evaluation took 0.000354 seconds</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 3.54 seconds.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Adjust your expectations accordingly!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: WARNING: There aren't enough warmup iterations to fit the</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1:          three stages of adaptation as currently configured.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1:          Reducing each adaptation stage to 15%/75%/10% of</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1:          the given number of warmup iterations:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1:            init_buffer = 7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1:            adapt_window = 38</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1:            term_buffer = 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration:  1 / 100 [  1%]  (Warmup)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 10 / 100 [ 10%]  (Warmup)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 20 / 100 [ 20%]  (Warmup)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 30 / 100 [ 30%]  (Warmup)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 40 / 100 [ 40%]  (Warmup)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 50 / 100 [ 50%]  (Warmup)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 51 / 100 [ 51%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 60 / 100 [ 60%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 70 / 100 [ 70%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 80 / 100 [ 80%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 90 / 100 [ 90%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 100 / 100 [100%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1:  Elapsed Time: 3.45 seconds (Warm-up)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1:                8.113 seconds (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1:                11.563 seconds (Total)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: </span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>The largest R-hat is 1.14, indicating chains have not mixed.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> Running the chains for more iterations may help. See</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> https://mc-stan.org/misc/warnings.html#r-hat</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Bulk Effective Samples Size (ESS) is too low, indicating posterior means and medians may be unreliable.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> Running the chains for more iterations may help. See</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> https://mc-stan.org/misc/warnings.html#bulk-ess</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Tail Effective Samples Size (ESS) is too low, indicating posterior variances and tail quantiles may be unreliable.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> Running the chains for more iterations may help. See</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> https://mc-stan.org/misc/warnings.html#tail-ess</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitting a multivariate joint model.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Please note the warmup may be much slower than later iterations!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SAMPLING FOR MODEL 'jm' NOW (CHAIN 1).</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Gradient evaluation took 0.00028 seconds</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 2.8 seconds.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Adjust your expectations accordingly!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration:   1 / 1000 [  0%]  (Warmup)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 100 / 1000 [ 10%]  (Warmup)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 200 / 1000 [ 20%]  (Warmup)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 300 / 1000 [ 30%]  (Warmup)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 400 / 1000 [ 40%]  (Warmup)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 500 / 1000 [ 50%]  (Warmup)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 501 / 1000 [ 50%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 600 / 1000 [ 60%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 700 / 1000 [ 70%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 800 / 1000 [ 80%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 900 / 1000 [ 90%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 1000 / 1000 [100%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1:  Elapsed Time: 16.231 seconds (Warm-up)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1:                7.422 seconds (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1:                23.653 seconds (Total)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: </span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>The largest R-hat is 1.06, indicating chains have not mixed.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> Running the chains for more iterations may help. See</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> https://mc-stan.org/misc/warnings.html#r-hat</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Bulk Effective Samples Size (ESS) is too low, indicating posterior means and medians may be unreliable.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> Running the chains for more iterations may help. See</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> https://mc-stan.org/misc/warnings.html#bulk-ess</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jonah Gabry, Ben Goodrich.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

