<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!-- upstream: inst/BS5/templates/head.html; pkgdown-version: 2.1.3, fe04924 --><!-- https://github.com/r-lib/pkgdown/tree/fe04924b3df129bea60ac871614b01d87bcae147 --><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Estimating Ordinal Regression Models with rstanarm • rstanarm</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_3-0.4.10/font.css" rel="stylesheet">
<link href="../deps/Source_Code_Pro-0.4.10/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- Font Awesome 7.0.1 for Bluesky icon --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css" referrerpolicy="no-referrer">
<!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Estimating Ordinal Regression Models with rstanarm">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <!-- upstream: inst/BS5/templates/navbar.html; pkgdown-version: 2.1.3, fe04924 -->
<!-- https://github.com/r-lib/pkgdown/tree/fe04924b3df129bea60ac871614b01d87bcae147 -->
<nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">


    <a class="navbar-brand me-2" href="../index.html">
      <!-- Add Stan logo -->
      <picture><source type="image/svg+xml" srcset="../logo.svg"><img src="../logo.png" class="stan-logo" alt="Stan blue hex logo"></source></picture>
      rstanarm
    </a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">2.32.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html" aria-label="Go to homepage"><span class="fa fa-home fa-lg"></span></a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/index.html">Vignettes</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-other-packages" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Other Packages</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-other-packages">
<li><a class="external-link dropdown-item" href="https://mc-stan.org/bayesplot">bayesplot</a></li>
    <li><a class="external-link dropdown-item" href="https://mc-stan.org/cmdstanr">cmdstanr</a></li>
    <li><a class="external-link dropdown-item" href="https://mc-stan.org/loo">loo</a></li>
    <li><a class="external-link dropdown-item" href="https://mc-stan.org/posterior">posterior</a></li>
    <li><a class="external-link dropdown-item" href="https://mc-stan.org/projpred">projpred</a></li>
    <li><a class="external-link dropdown-item" href="https://mc-stan.org/rstan">rstan</a></li>
    <li><a class="external-link dropdown-item" href="https://mc-stan.org/rstantools">rstantools</a></li>
    <li><a class="external-link dropdown-item" href="https://mc-stan.org/shinystan">shinystan</a></li>
  </ul>
</li>
<li class="nav-item"><a class="external-link nav-link" href="https://mc-stan.org/about/">About Stan</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://bsky.app/profile/did:plc:qznndgdnkem2yryu7ipqbpv7" aria-label="Visit our Bluesky profile"><span class="fa fa-brands fa-bluesky"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://discourse.mc-stan.org/" aria-label="Visit our forums"><span class="fa fa-users"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/stan-dev/rstanarm/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Estimating Ordinal Regression Models with rstanarm</h1>
                        <h4 data-toc-skip class="author">Jonah Gabry and
Ben Goodrich</h4>
            
            <h4 data-toc-skip class="date">2025-12-03</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/stan-dev/rstanarm/blob/New-pkgdown-theme/vignettes/polr.Rmd" class="external-link"><code>vignettes/polr.Rmd</code></a></small>
      <div class="d-none name"><code>polr.Rmd</code></div>
    </div>

    
    
<!--
%\VignetteEngine{knitr::rmarkdown}
%\VignetteIndexEntry{stan_polr: Ordinal Models}
-->
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mc-stan.org/bayesplot/" class="external-link">bayesplot</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/get_theme.html" class="external-link">theme_set</a></span><span class="op">(</span><span class="fu">bayesplot</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/bayesplot/reference/theme_default.html" class="external-link">theme_default</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette explains how to estimate models for ordinal outcomes
using the <code>stan_polr</code> function in the
<strong>rstanarm</strong> package.</p>
<p>The four steps of a Bayesian analysis are</p>
<ol style="list-style-type: decimal">
<li>Specify a joint distribution for the outcome(s) and all the
unknowns, which typically takes the form of a marginal prior
distribution for the unknowns multiplied by a likelihood for the
outcome(s) conditional on the unknowns. This joint distribution is
proportional to a posterior distribution of the unknowns conditional on
the observed data</li>
<li>Draw from posterior distribution using Markov Chain Monte Carlo
(MCMC).</li>
<li>Evaluate how well the model fits the data and possibly revise the
model.</li>
<li>Draw from the posterior predictive distribution of the outcome(s)
given interesting values of the predictors in order to visualize how a
manipulation of a predictor affects (a function of) the outcome(s).</li>
</ol>
<p>Steps 3 and 4 are covered in more depth by the vignette entitled <a href="rstanarm.html">“How to Use the <strong>rstanarm</strong>
Package”</a>. This vignette focuses on Step 1.</p>
<p>One of the strengths of doing MCMC with Stan — as opposed to a Gibbs
sampler — is that reparameterizations are essentially costless, which
allows the user to specify priors on parameters that are either more
intuitive, numerically stable, or computationally efficient without
changing the posterior distribution of the parameters that enter the
likelihood. Advantageous parameterizations are already built into the
Stan programs used in the <strong>rstanarm</strong> package, so it is
just a matter of using these vignettes to explain how the priors work in
the context of these reparameterizations.</p>
</div>
<div class="section level2">
<h2 id="likelihood">Likelihood<a class="anchor" aria-label="anchor" href="#likelihood"></a>
</h2>
<p>Ordinal outcomes fall in one of <span class="math inline">\(J\)</span> categories. One way to motivate an
ordinal model is to introduce a latent variable, <span class="math inline">\(y^\ast\)</span>, that is related to the observed
outcomes via an observation mechanism: <span class="math display">\[y=\begin{cases}
1 &amp; \mbox{if }y^{\ast}&lt;\zeta_{1}\\
2 &amp; \mbox{if }\zeta_{1}\leq y^{\ast}&lt;\zeta_{2}\\
\vdots\\
J &amp; \mbox{if }\zeta_{J-1}\leq y^{\ast}
\end{cases},\]</span> where <span class="math inline">\(\boldsymbol{\zeta}\)</span> is a vector of
cutpoints of length <span class="math inline">\(J-1\)</span>.</p>
<p>Then <span class="math inline">\(y^\ast\)</span> is modeled as a
linear function of <span class="math inline">\(K\)</span> predictors
<span class="math display">\[y^\ast = \mu + \epsilon = \mathbf{x}^\top
\boldsymbol{\beta} + \epsilon,\]</span> where <span class="math inline">\(\epsilon\)</span> has mean zero and unit scale but
can be specified as being drawn from one of several distributions. Note
that there is no “intercept” in this model since the data cannot
distinguish an intercept from the cutpoints. However, if <span class="math inline">\(J = 2\)</span>, then <span class="math inline">\(\zeta_1\)</span> can be referred to as either the
cutpoint or the intercept.</p>
<p>A Bayesian can treat <span class="math inline">\(y^\ast\)</span> as
another unknown parameter, although for computational efficiency the
Stan code essentially integrates each <span class="math inline">\(y^\ast\)</span> out of the posterior distribution,
leaving the posterior distribution of <span class="math inline">\(\boldsymbol{\beta}\)</span> and <span class="math inline">\(\boldsymbol{\zeta}\)</span>. Nevertheless, it is
useful to motivate the model theoretically as if <span class="math inline">\(y^\ast\)</span> were just an unknown parameter
with a distribution truncated by the relevant element(s) of <span class="math inline">\(\boldsymbol{\zeta}\)</span>.</p>
</div>
<div class="section level2">
<h2 id="priors">Priors<a class="anchor" aria-label="anchor" href="#priors"></a>
</h2>
<p>If <span class="math inline">\(y^\ast\)</span> were observed we would
simply have a linear regression model for it, and the description of the
priors in the vignette entitled <a href="lm.html">“Estimating Linear
Models with the <strong>rstanarm</strong> Package”</a> would apply
directly. Another way to say the same thing is <em>conditional</em> on a
realization of <span class="math inline">\(y^\ast\)</span>, we have a
linear regression model and the description of the priors in the other
<a href="lm.html">vignette</a> does apply (and should be read before
continuing with this subsection).</p>
<p>The <code>stan_lm</code> function essentially specifies a prior on
<span class="math inline">\(\boldsymbol{\theta} = \mathbf{R}^{-1}
\boldsymbol{\beta}\)</span>, where <span class="math inline">\(\mathbf{R}\)</span> is the upper triangular matrix
in the QR decomposition of the design matrix, <span class="math inline">\(\mathbf{X} = \mathbf{Q} \mathbf{R}\)</span>.
Furthermore, in <code>stan_lm</code>, <span class="math inline">\(\sigma_{\epsilon} = \sigma_y \sqrt{1 -
R^2}\)</span> where <span class="math inline">\(R^2\)</span> is the
proportion of variance in the outcome that is attributable to the
coefficients in a linear model.</p>
<p>The main difference in the context of a model for an ordinal outcome
is that the scale of <span class="math inline">\(y^\ast\)</span> is not
identified by the data. Thus, the ordinal model specifies that <span class="math inline">\(\sigma_{\epsilon} = 1\)</span>, which implies that
<span class="math inline">\(\sigma_{y^\ast} = 1 / \sqrt{1 -
R^2}\)</span> is an intermediate parameter rather than a primitive
parameter.</p>
<p>It is somewhat more difficult to specify a prior value for the <span class="math inline">\(R^2\)</span> in an ordinal model because <span class="math inline">\(R^2\)</span> refers to the proportion of variance
in the <span class="math inline">\(y^\ast\)</span> that is attributable
to the predictors under a linear model. In general, the <span class="math inline">\(R^2\)</span> tends to be lower in an ordinal model
than in a linear model where the continuous outcome is observed.</p>
<p>The other difference is that an ordinal model does not have a global
intercept but rather a vector of <span class="math inline">\(J-1\)</span> cutpoints. The implied prior on these
cutpoints used by the <strong>rstanarm</strong> package is somewhat
novel. The user instead specifies a Dirichlet prior on <span class="math inline">\(\Pr\left(y=j \, \left.\right| \,
\overline{\mathbf{x}} \right)\)</span>, which is to say the prior
probability of the outcome falling in each of the <span class="math inline">\(J\)</span> categories given that the predictors
are at their sample means. The Dirichlet prior is for a simplex random
variable, whose elements are non-negative and sum to <span class="math inline">\(1\)</span>. The Dirichlet PDF can be written as
<span class="math display">\[f\left(\boldsymbol{\pi}|\boldsymbol{\alpha}\right)
\propto
\prod_{j=1}^J{\pi_j^{\alpha_j - 1}}, \]</span> where <span class="math inline">\(\boldsymbol{\pi}\)</span> is a simplex vector such
that <span class="math inline">\(\pi_j = \Pr\left(y=j \, \left.\right|
\, \overline{\mathbf{x}} \right)\)</span>.</p>
<p>The Dirichlet prior is one of the easiest to specify because the
so-called “concentration” hyperparameters <span class="math inline">\(\boldsymbol{\alpha}\)</span> can be interpreted as
prior counts, i.e., prior observations for each of the J categories
(although they need not be integers). If <span class="math inline">\(\alpha_j = 1\)</span> for every <span class="math inline">\(j\)</span> (the default used by
<strong>rstanarm</strong>) then the Dirichlet prior is jointly uniform
over the space of these simplexes. This corresponds to a prior count of
one observation falling in each of the <span class="math inline">\(J\)</span> ordinal categories when the predictors
are at their sample means and conveys the reasonable but weak prior
information that no category has probability zero. If, for each <span class="math inline">\(j\)</span>, <span class="math inline">\(\alpha_j =
\alpha &gt; 1\)</span> then the prior mode is that the <span class="math inline">\(J\)</span> categories are equiprobable, with prior
probability <span class="math inline">\(1/J\)</span> of the outcome
falling in each of the <span class="math inline">\(J\)</span>
categories. The larger the value of <span class="math inline">\(\alpha\)</span> the more sharply peaked the
distribution is at the mode.</p>
<p>The <span class="math inline">\(j\)</span>-th cutpoint <span class="math inline">\(\zeta_j\)</span> is then given by <span class="math display">\[\zeta_j =
F_{y^\ast}^{-1}\left(\sum_{i=1}^j{\pi_i}\right),\]</span> where <span class="math inline">\(F_{y^\ast}^{-1}\)</span> is an inverse CDF
function, which depends on the assumed distribution of <span class="math inline">\(y^\ast\)</span>. Common choices include the normal
and logistic distributions. The scale parameter of this distribution is
again <span class="math inline">\(\sigma_{y^\ast} = 1/\sqrt{1 -
R^2}\)</span>. In short, by making each <span class="math inline">\(\zeta_j\)</span> a function of <span class="math inline">\(\boldsymbol{\pi}\)</span>, it allows us to specify
a Dirichlet prior on <span class="math inline">\(\boldsymbol{\pi}\)</span>, which is simpler than
specifying a prior on <span class="math inline">\(\boldsymbol{\zeta}\)</span> directly.</p>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<p>In this section, we start with an ordinal model of tobacco
consumption as a function of age and alcohol consumption. Frequentist
estimates can be obtained using the <code>polr</code> function in the
<strong>MASS</strong> package:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/" class="external-link">MASS</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/polr.html" class="external-link">polr</a></span><span class="op">(</span><span class="va">tobgp</span> <span class="op">~</span> <span class="va">agegp</span> <span class="op">+</span> <span class="va">alcgp</span>, data <span class="op">=</span> <span class="va">esoph</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<pre><code>Call:
polr(formula = tobgp ~ agegp + alcgp, data = esoph)

Coefficients:
agegp.L agegp.Q agegp.C agegp^4 agegp^5 alcgp.L alcgp.Q alcgp.C 
  -0.37   -0.38   -0.24    0.04   -0.04   -0.19   -0.02    0.03 

Intercepts:
0-9g/day|10-19    10-19|20-29      20-29|30+ 
          -1.0            0.2            1.3 

Residual Deviance: 241.8195 
AIC: 263.8195 </code></pre>
<p>To obtain Bayesian estimates, we prepend <code>stan_</code> and
specify the priors:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mc-stan.org/rstanarm/">rstanarm</a></span><span class="op">)</span></span>
<span><span class="va">post0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/stan_polr.html">stan_polr</a></span><span class="op">(</span><span class="va">tobgp</span> <span class="op">~</span> <span class="va">agegp</span> <span class="op">+</span> <span class="va">alcgp</span>, data <span class="op">=</span> <span class="va">esoph</span>, </span>
<span>                   prior <span class="op">=</span> <span class="fu"><a href="../reference/priors.html">R2</a></span><span class="op">(</span><span class="fl">0.25</span><span class="op">)</span>, prior_counts <span class="op">=</span> <span class="fu"><a href="../reference/priors.html">dirichlet</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>                   seed <span class="op">=</span> <span class="fl">12345</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">post0</span>, digits <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<pre><code>stan_polr
 family:       ordered [logistic]
 formula:      tobgp ~ agegp + alcgp
 observations: 88
------
        Median MAD_SD
agegp.L -0.2    0.4  
agegp.Q -0.2    0.4  
agegp.C -0.1    0.3  
agegp^4  0.0    0.3  
agegp^5  0.0    0.3  
alcgp.L -0.1    0.3  
alcgp.Q  0.0    0.3  
alcgp.C  0.0    0.3  

Cutpoints:
               Median MAD_SD
0-9g/day|10-19 -1.0    0.2  
10-19|20-29     0.2    0.2  
20-29|30+       1.3    0.2  

------
* For help interpreting the printed output see ?print.stanreg
* For info on the priors used see ?prior_summary.stanreg</code></pre>
<p>The point estimates, represented by the posterior medians, are
qualitatively similar to the maximum-likelihood estimates but are
somewhat shrunk toward zero due to the regularizing prior on the
coefficients. Since these cutpoints are actually <em>known</em>, it
would be more appropriate for the model to take that into account, but
<code>stan_polr</code> does not currently support that.</p>
<p>Next, we utilize an example from the <strong>MASS</strong> package
where low birthweight is the binary outcome of interest. First, we
recode some of the variables:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"birthwt"</span>, package <span class="op">=</span> <span class="st">"MASS"</span><span class="op">)</span></span>
<span><span class="va">birthwt</span><span class="op">$</span><span class="va">race</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">birthwt</span><span class="op">$</span><span class="va">race</span>, levels <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, </span>
<span>                       labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"white"</span>, <span class="st">"black"</span>, <span class="st">"other"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">birthwt</span><span class="op">$</span><span class="va">bwt</span> <span class="op">&lt;-</span> <span class="va">birthwt</span><span class="op">$</span><span class="va">bwt</span> <span class="op">/</span> <span class="fl">1000</span> <span class="co"># convert from grams to kilograms</span></span>
<span><span class="va">birthwt</span><span class="op">$</span><span class="va">low</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">birthwt</span><span class="op">$</span><span class="va">low</span>, levels <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">1</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"no"</span>, <span class="st">"yes"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>It is usually a good idea to rescale variables by constants so that
all the numbers are in single or double digits. We start by estimating a
linear model for birthweight in kilograms, flipping the sign so that
positive coefficients are associated with <em>lower</em>
birthweights.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">post1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/stan_lm.html">stan_lm</a></span><span class="op">(</span><span class="op">-</span><span class="va">bwt</span> <span class="op">~</span> <span class="va">smoke</span> <span class="op">+</span> <span class="va">age</span> <span class="op">+</span> <span class="va">race</span> <span class="op">+</span> <span class="va">ptl</span> <span class="op">+</span> <span class="va">ht</span> <span class="op">+</span> <span class="va">ftv</span>,</span>
<span>                 data <span class="op">=</span> <span class="va">birthwt</span>, prior <span class="op">=</span> <span class="fu"><a href="../reference/priors.html">R2</a></span><span class="op">(</span><span class="fl">0.5</span><span class="op">)</span>, </span>
<span>                 seed <span class="op">=</span> <span class="fl">12345</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">post1</span><span class="op">)</span></span></code></pre></div>
<pre><code>stan_lm
 family:       gaussian [identity]
 formula:      -bwt ~ smoke + age + race + ptl + ht + ftv
 observations: 189
 predictors:   8
------
            Median MAD_SD
(Intercept) -3.3    0.2  
smoke        0.4    0.1  
age          0.0    0.0  
raceblack    0.4    0.2  
raceother    0.4    0.1  
ptl          0.2    0.1  
ht           0.4    0.2  
ftv          0.0    0.0  

Auxiliary parameter(s):
              Median MAD_SD
R2            0.2    0.0   
log-fit_ratio 0.0    0.1   
sigma         0.7    0.0   

------
* For help interpreting the printed output see ?print.stanreg
* For info on the priors used see ?prior_summary.stanreg</code></pre>
<p>Next, we estimate an “ordinal” model for the incidence of low
birthweight, which is defined as a birth weight of less than <span class="math inline">\(2.5\)</span> kilograms. Even though this outcome
is binary, a binary variable is a special case of an ordinal variable
with <span class="math inline">\(J=2\)</span> categories and is
acceptable to <code>stan_polr</code>. We can think of <code>bwt</code>
as something proportional to <span class="math inline">\(y^\ast\)</span>
and pretend that it is not observed, forcing us to estimate an ordinal
model.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">post2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/stan_polr.html">stan_polr</a></span><span class="op">(</span><span class="va">low</span> <span class="op">~</span> <span class="va">smoke</span> <span class="op">+</span> <span class="va">age</span> <span class="op">+</span> <span class="va">race</span> <span class="op">+</span> <span class="va">ptl</span> <span class="op">+</span> <span class="va">ht</span> <span class="op">+</span> <span class="va">ftv</span>, data <span class="op">=</span> <span class="va">birthwt</span>,</span>
<span>                   prior <span class="op">=</span> <span class="fu"><a href="../reference/priors.html">R2</a></span><span class="op">(</span><span class="fl">0.5</span><span class="op">)</span>, prior_counts <span class="op">=</span> <span class="fu"><a href="../reference/priors.html">dirichlet</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                   method <span class="op">=</span> <span class="st">"probit"</span>, seed <span class="op">=</span> <span class="fl">12345</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="../reference/loo.stanreg.html">loo</a></span><span class="op">(</span><span class="va">post2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="polr_files/figure-html/polr-loo-plot-1.png" class="r-plt" width="60%" style="display: block; margin: auto;"></p>
<p>This prior seems to have worked well in this case because none of the
points in the plot are above <span class="math inline">\(0.5\)</span>,
which would have indicated the the posterior is very sensitive to those
observations. If we compare the estimated coefficients,</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>Linear <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">post1</span><span class="op">)</span>, Ordinal <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">post2</span><span class="op">)</span>, </span>
<span>            Rescaled <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">post1</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="../reference/stanreg-methods.html">sigma</a></span><span class="op">(</span><span class="va">post1</span><span class="op">)</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<pre><code>            Linear Ordinal Rescaled
(Intercept) -3.254  -0.535   -4.812
smoke        0.361   0.514    0.534
age         -0.003  -0.025   -0.005
raceblack    0.394   0.514    0.582
raceother    0.400   0.530    0.592
ptl          0.154   0.400    0.228
ht           0.368   0.696    0.544
ftv         -0.004  -0.005   -0.006</code></pre>
<p>they have the same signs and similar magnitudes, with the exception
of the “Intercept”. In an ordinal model where the outcome only has <span class="math inline">\(J=2\)</span> categories, this “Intercept” is
actually <span class="math inline">\(\zeta_1\)</span>, but it is more
conventional to call it the “Intercept” so that it agrees with
<code>stan_glm</code> when
<code>family = binomial(link = 'probit')</code>. Recall that <span class="math inline">\(\sigma_{\epsilon} = 1\)</span> in an ordinal
model, so if we rescale the coefficients from a linear model by dividing
by the posterior median of <span class="math inline">\(\sigma\)</span>,
the resulting coefficients are even closer to those of the ordinal
model.</p>
<p>This illustrates the fundamental similarity between a linear model
for a continuous observed outcome and a linear model for a latent <span class="math inline">\(y^\ast\)</span> that generates an ordinal observed
outcome. The main difference is when the outcome is continuous and
observed, we can estimate the scale of the errors meaningfully. When the
outcome is ordinal, we can only fix the scale of the latent errors to
<span class="math inline">\(1\)</span> arbitrarily.</p>
<p>Finally, when <span class="math inline">\(J = 2\)</span>, the
<code>stan_polr</code> function allows you to specify
non-<code>NULL</code> values of the <code>shape</code> and
<code>rate</code> arguments, which implies a “scobit” likelihood where
the probability of success is given by <span class="math inline">\(F\left(y^\ast \right)^\alpha\)</span>, where <span class="math inline">\(F\left(\right)\)</span> is the logistic CDF and
<span class="math inline">\(\alpha &gt; 0\)</span> is a skewing
parameter that has a gamma prior with a given <code>shape</code> and
<code>rate</code>. If <span class="math inline">\(\alpha \neq
1\)</span>, then the relationship between <span class="math inline">\(y^\ast\)</span> and the probability of success is
asymmetric. In principle, it seems appropriate to estimate <span class="math inline">\(\alpha\)</span> but in practice, a lot of data is
needed to estimate <span class="math inline">\(\alpha\)</span> with
adequate precision. In the previous example, if we specify
<code>shape = 2</code> and <code>rate = 2</code> to reflect the prior
beliefs that <span class="math inline">\(\alpha\)</span> is expected to
be <span class="math inline">\(1\)</span> but has a variance of <span class="math inline">\(\frac{1}{2}\)</span>, then the <code>loo</code>
calculation yields many Pareto shape parameters that are excessively
large. However, with more than <span class="math inline">\(189\)</span>
observations, such a model may be more fruitful.</p>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>The posterior distribution for an ordinal model requires priors on
the coefficients and the cutpoints. The priors used by the
<code>stan_polr</code> function are unconventional but should work well
for a variety of problems. The prior on the coefficients is essentially
the same as that used by the <code>stan_lm</code> function but omits a
scale parameter because the standard deviation of the latent <span class="math inline">\(y^\ast\)</span> is not identified by the data. The
cutpoints are conditionally deterministic given a simplex vector for the
probability of falling in each of the <span class="math inline">\(J\)</span> ordinal categories given that the
predictors are at their sample means. Thus, a Dirichlet prior — which is
relatively easy to specify and has a good default of jointly uniform —
on this simplex completes the posterior distribution.</p>
<p>This approach provides an alternative to <code>stan_glm</code> with
<code>family = binomial()</code> even if the outcome variable has only
two categories. The <code>stan_glm</code> function has more options for
the prior on the coefficients and the prior on the intercept (which can
be interpreted as the first cutpoint when <span class="math inline">\(J
= 2\)</span>). However, it may be more difficult to obtain efficient
sampling with those priors.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jonah Gabry, Ben Goodrich.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
