<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!-- upstream: inst/BS5/templates/head.html; pkgdown-version: 2.1.3, fe04924 --><!-- https://github.com/r-lib/pkgdown/tree/fe04924b3df129bea60ac871614b01d87bcae147 --><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Modeling Rates/Proportions using Beta Regression with rstanarm • rstanarm</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_3-0.4.10/font.css" rel="stylesheet">
<link href="../deps/Source_Code_Pro-0.4.10/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- Font Awesome 7.0.1 for Bluesky icon --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css" referrerpolicy="no-referrer">
<!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Modeling Rates/Proportions using Beta Regression with rstanarm">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <!-- upstream: inst/BS5/templates/navbar.html; pkgdown-version: 2.1.3, fe04924 -->
<!-- https://github.com/r-lib/pkgdown/tree/fe04924b3df129bea60ac871614b01d87bcae147 -->
<nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">


    <a class="navbar-brand me-2" href="../index.html">
      <!-- Add Stan logo -->
      <picture><source type="image/svg+xml" srcset="../logo.svg"><img src="../logo.png" class="stan-logo" alt="Stan blue hex logo"></source></picture>
      rstanarm
    </a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.32.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html" aria-label="Go to homepage"><span class="fa fa-home fa-lg"></span></a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/index.html">Vignettes</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-other-packages" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Other Packages</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-other-packages">
<li><a class="external-link dropdown-item" href="https://mc-stan.org/bayesplot">bayesplot</a></li>
    <li><a class="external-link dropdown-item" href="https://mc-stan.org/cmdstanr">cmdstanr</a></li>
    <li><a class="external-link dropdown-item" href="https://mc-stan.org/loo">loo</a></li>
    <li><a class="external-link dropdown-item" href="https://mc-stan.org/posterior">posterior</a></li>
    <li><a class="external-link dropdown-item" href="https://mc-stan.org/projpred">projpred</a></li>
    <li><a class="external-link dropdown-item" href="https://mc-stan.org/rstan">rstan</a></li>
    <li><a class="external-link dropdown-item" href="https://mc-stan.org/rstantools">rstantools</a></li>
    <li><a class="external-link dropdown-item" href="https://mc-stan.org/shinystan">shinystan</a></li>
  </ul>
</li>
<li class="nav-item"><a class="external-link nav-link" href="https://mc-stan.org/about/">About Stan</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://bsky.app/profile/did:plc:qznndgdnkem2yryu7ipqbpv7" aria-label="Visit our Bluesky profile"><span class="fa fa-brands fa-bluesky"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://discourse.mc-stan.org/" aria-label="Visit our forums"><span class="fa fa-users"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/stan-dev/rstanarm/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Modeling Rates/Proportions using Beta Regression with rstanarm</h1>
                        <h4 data-toc-skip class="author">Imad Ali, Jonah
Gabry and Ben Goodrich</h4>
            
            <h4 data-toc-skip class="date">2025-12-01</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/stan-dev/rstanarm/blob/New-pkgdown-theme/vignettes/betareg.Rmd" class="external-link"><code>vignettes/betareg.Rmd</code></a></small>
      <div class="d-none name"><code>betareg.Rmd</code></div>
    </div>

    
    
<!--
%\VignetteEngine{knitr::rmarkdown}
%\VignetteIndexEntry{stan_betareg: Models for Rate/Proportion Data}
-->
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mc-stan.org/bayesplot/" class="external-link">bayesplot</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/get_theme.html" class="external-link">theme_set</a></span><span class="op">(</span><span class="fu">bayesplot</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/bayesplot/reference/theme_default.html" class="external-link">theme_default</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette explains how to model continuous outcomes on the open
unit interval using the <code>stan_betareg</code> function in the
<strong>rstanarm</strong> package.</p>
<p>The four steps of a Bayesian analysis are</p>
<ol style="list-style-type: decimal">
<li>Specify a joint distribution for the outcome(s) and all the
unknowns, which typically takes the form of a marginal prior
distribution for the unknowns multiplied by a likelihood for the
outcome(s) conditional on the unknowns. This joint distribution is
proportional to a posterior distribution of the unknowns conditional on
the observed data</li>
<li>Draw from posterior distribution using Markov Chain Monte Carlo
(MCMC).</li>
<li>Evaluate how well the model fits the data and possibly revise the
model.</li>
<li>Draw from the posterior predictive distribution of the outcome(s)
given interesting values of the predictors in order to visualize how a
manipulation of a predictor affects (a function of) the outcome(s).</li>
</ol>
<p>Steps 3 and 4 are covered in more depth by the vignette entitled <a href="rstanarm.html">“How to Use the <strong>rstanarm</strong>
Package”</a>. This vignette focuses on Step 1 when the likelihood is the
product of beta distributions.</p>
</div>
<div class="section level2">
<h2 id="likelihood">Likelihood<a class="anchor" aria-label="anchor" href="#likelihood"></a>
</h2>
<p>Beta regression uses the beta distribution as the likelihood for the
data, <span class="math display">\[
f(y_i | a, b) = \frac{y_i^{(a-1)}(1-y_i)^{(b-1)}}{B(a,b)}
\]</span> where <span class="math inline">\(B(\cdot)\)</span> is the
beta function. The shape parameters for the distribution are <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> and enter into the model according to
the following transformations, <span class="math display">\[
a = \mu\cdot\phi \\
b = (1-\mu)\cdot\phi
\]</span></p>
<p>Let <span class="math inline">\(g_1(\cdot)\)</span> be some link
function. Then, in the specification of the shape parameters above,
<span class="math inline">\(\mu =
g_1^{-1}(\mathbf{X}\boldsymbol{\beta})\)</span>, where <span class="math inline">\(\boldsymbol{X}\)</span> is a <span class="math inline">\(N\times K\)</span> dimensional matrix of
predictors, and <span class="math inline">\(\boldsymbol{\beta}\)</span>
is a <span class="math inline">\(K\)</span> dimensional vector of
parameters associated with each predictor.</p>
<p>In the simplest case (with only one set of regressors), <span class="math inline">\(\phi\)</span> is a scalar parameter.
Alternatively, it is possible to model <span class="math inline">\(\phi\)</span> using a second set of regressors
<span class="math inline">\(\mathbf{Z}\)</span>. In this context let
<span class="math inline">\(g_2(\cdot)\)</span> be some link function
that is not necessarily identical to <span class="math inline">\(g_1(\cdot)\)</span>. Then <span class="math inline">\(\phi =
g_2^{-1}(\mathbf{Z}\boldsymbol{\gamma})\)</span>, where <span class="math inline">\(\boldsymbol{\gamma}\)</span> is a <span class="math inline">\(J\)</span> dimensional vector of parameters
associated with the <span class="math inline">\(N\times J\)</span>
dimensional matrix of predictors <span class="math inline">\(\mathbf{Z}\)</span>.</p>
<p>After substituting the shape parameter values in, the likelihood used
in beta regression takes the following form, <span class="math display">\[
f(y_i | \mu, \phi) =
\frac{y_i^{(\mu\phi-1)}(1-y_i)^{((1-\mu)\phi-1)}}{B(\mu\phi,(1-\mu)\phi)}
\]</span></p>
</div>
<div class="section level2">
<h2 id="priors">Priors<a class="anchor" aria-label="anchor" href="#priors"></a>
</h2>
<p>A full Bayesian analysis requires specifying prior distributions
<span class="math inline">\(f(\boldsymbol{\beta})\)</span> and <span class="math inline">\(f(\phi)\)</span> for the vector of regression
coefficients and <span class="math inline">\(\phi\)</span>. When using
<code>stan_betareg</code>, these distributions can be set using the
<code>prior_intercept</code>, <code>prior</code>, and
<code>prior_phi</code> arguments. The <code>stan_betareg</code> function
supports a variety of prior distributions, which are explained in the
<strong>rstanarm</strong> documentation
(<code><a href="../reference/priors.html">help(priors, package = 'rstanarm')</a></code>).</p>
<p>When modeling <span class="math inline">\(\phi\)</span> with a linear
predictor a full Bayesian analysis requires specifying the prior
distributions <span class="math inline">\(f(\boldsymbol{\beta})\)</span>
and <span class="math inline">\(f(\boldsymbol{\gamma})\)</span>. In
<code>stan_betareg</code> the prior distributions on <span class="math inline">\(\boldsymbol{\gamma}\)</span> can be set using the
<code>prior_intercept_z</code> and <code>prior_z</code> arguments.</p>
<p>As an example, suppose we have <span class="math inline">\(K\)</span>
predictors and believe — prior to seeing the data — that <span class="math inline">\(\beta_1, \dots, \beta_K\)</span> and <span class="math inline">\(\phi\)</span> are as likely to be positive as they
are to be negative, but are highly unlikely to be far from zero. These
beliefs can be represented by normal distributions with mean zero and a
small scale (standard deviation). To give <span class="math inline">\(\phi\)</span> and each of the <span class="math inline">\(\beta\)</span>s this prior (with a scale of 1,
say), in the call to <code>stan_betareg</code> we would include the
arguments <code>prior_intercept = normal(0,1)</code>,
<code>prior = normal(0,1)</code>, and
<code>prior_phi = normal(0,1)</code>.</p>
<p>If, on the other hand, we have less a priori confidence that the
parameters will be close to zero then we could use a larger scale for
the normal distribution and/or a distribution with heavier tails than
the normal like the Student t distribution. <strong>Step 1</strong> in
the “How to Use the <strong>rstanarm</strong> Package” vignette
discusses one such example.</p>
<p>After fitting the model we can use the <code>prior_summary</code>
function to print information about the prior distributions used when
fitting the model.</p>
</div>
<div class="section level2">
<h2 id="posterior">Posterior<a class="anchor" aria-label="anchor" href="#posterior"></a>
</h2>
<p>When using only a <em>single set of regressors</em>, the posterior
distribution of <span class="math inline">\(\boldsymbol{\beta}\)</span>
and <span class="math inline">\(\phi\)</span> is proportional to the
product of the likelihood contributions, the <span class="math inline">\(K\)</span> priors on the <span class="math inline">\(\beta_k\)</span> parameters, and <span class="math inline">\(\phi\)</span>, <span class="math display">\[
f(\boldsymbol{\beta},\phi|\mathbf{y},\mathbf{X}) \propto
\prod_{i=1}^N f(y_i | a, b) \times
\prod_{k=1}^K f(\beta_k) \times
f(\phi)
\]</span></p>
<p>When using <em>two sets of regressors</em>, the posterior
distribution of <span class="math inline">\(\boldsymbol{\beta}\)</span>
and <span class="math inline">\(\boldsymbol{\gamma}\)</span> is
proportional to the product of the likelihood contribution, the <span class="math inline">\(K\)</span> priors on the <span class="math inline">\(\beta_k\)</span> parameters, and the <span class="math inline">\(J\)</span> priors on the <span class="math inline">\(\gamma_j\)</span> parameters,</p>
<p><span class="math display">\[
f(\boldsymbol{\beta},\boldsymbol{\gamma}|\mathbf{y},\mathbf{X}) \propto
\prod_{i=1}^N f(y_i | a, b) \times
\prod_{k=1}^K f(\beta_k) \times
\prod_{j=1}^J f(\gamma_j)
\]</span></p>
</div>
<div class="section level2">
<h2 id="an-example-using-simulated-data">An Example Using Simulated Data<a class="anchor" aria-label="anchor" href="#an-example-using-simulated-data"></a>
</h2>
<p>In this example the outcome variable <span class="math inline">\(\mathbf{y}\)</span> is simulated in a way that
warrants the use of beta regression. It is worth mentioning that the
data generation process is quite convoluted, which is apparent in the
identification of the likelihood above.</p>
<p>The data simulated below uses the logistic link function on the first
set of regressors and the log link function on the second set of
regressors.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">SEED</span> <span class="op">&lt;-</span> <span class="fl">1234</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="va">SEED</span><span class="op">)</span></span>
<span><span class="va">eta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">gamma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.8</span>, <span class="fl">0.4</span><span class="op">)</span></span>
<span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">200</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">N</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">N</span>, <span class="fl">0</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">mu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span>link <span class="op">=</span> <span class="va">logit</span><span class="op">)</span><span class="op">$</span><span class="fu">linkinv</span><span class="op">(</span><span class="va">eta</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">eta</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">*</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="va">phi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span>link <span class="op">=</span> <span class="va">log</span><span class="op">)</span><span class="op">$</span><span class="fu">linkinv</span><span class="op">(</span><span class="va">gamma</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">gamma</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">*</span><span class="va">z</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">rbeta</a></span><span class="op">(</span><span class="va">N</span>, <span class="va">mu</span> <span class="op">*</span> <span class="va">phi</span>, <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">mu</span><span class="op">)</span> <span class="op">*</span> <span class="va">phi</span><span class="op">)</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">y</span>, <span class="va">x</span>, <span class="va">z</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">y</span>, col <span class="op">=</span> <span class="st">"darkgrey"</span>, border <span class="op">=</span> <span class="cn">F</span>, main <span class="op">=</span> <span class="st">"Distribution of Outcome Variable"</span>, xlab <span class="op">=</span> <span class="st">"y"</span>, breaks <span class="op">=</span> <span class="fl">20</span>, freq <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code></pre></div>
<p><img src="betareg_files/figure-html/simulated-data-1.png" class="r-plt" width="60%" style="display: block; margin: auto;"></p>
<p>The model can be fit by calling <code>stan_betareg</code>, using the
appropriate link functions.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mc-stan.org/rstanarm/">rstanarm</a></span><span class="op">)</span></span>
<span><span class="va">fit1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/stan_betareg.html">stan_betareg</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span> <span class="op">|</span> <span class="va">z</span>, data <span class="op">=</span> <span class="va">dat</span>, link <span class="op">=</span> <span class="st">"logit"</span>, link.phi <span class="op">=</span> <span class="st">"log"</span>,</span>
<span>                     cores <span class="op">=</span> <span class="fl">2</span>, seed <span class="op">=</span> <span class="fl">12345</span><span class="op">)</span></span>
<span><span class="va">fit2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/stan_betareg.html">stan_betareg</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="op">-</span><span class="fl">1</span> <span class="op">+</span> <span class="va">x</span> , data <span class="op">=</span> <span class="va">dat</span>, link <span class="op">=</span> <span class="st">"logit"</span>, link.phi <span class="op">=</span> <span class="st">"log"</span>,</span>
<span>                     cores <span class="op">=</span> <span class="fl">2</span>, seed <span class="op">=</span> <span class="fl">12345</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit1</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit2</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<pre><code>      (Intercept)                 x (phi)_(Intercept)           (phi)_z 
             0.93             -0.20              1.84              0.31 </code></pre>
<pre><code>                x (phi)_(Intercept) 
             0.00              1.08 </code></pre>
<p>For clarity we can use <code>prior_summary</code> to print the
information about the prior distributions used to fit the models. The
priors used in <code>fit1</code> are provided below.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/prior_summary.stanreg.html">prior_summary</a></span><span class="op">(</span><span class="va">fit1</span><span class="op">)</span></span></code></pre></div>
<pre><code>Priors for model 'fit1' 
------
Intercept (after predictors centered)
 ~ normal(location = 0, scale = 2.5)

Coefficients
  Specified prior:
    ~ normal(location = 0, scale = 2.5)
  Adjusted prior:
    ~ normal(location = 0, scale = 1.2)

Intercept_z (after predictors centered)
 ~ normal(location = 0, scale = 2.5)

Coefficients_z
  Specified prior:
    ~ normal(location = 0, scale = 2.5)
  Adjusted prior:
    ~ normal(location = 0, scale = 1.2)
------
See help('prior_summary.stanreg') for more details</code></pre>
<p>The usual posterior analyses are available in
<strong>rstanarm</strong>. The plots below illustrate simulated values
of the outcome variable. The incorrect model noticeably fails to capture
the top of the distribution consistently in comparison to the true
model.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mc-stan.org/bayesplot/" class="external-link">bayesplot</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://mc-stan.org/bayesplot/reference/bayesplot_grid.html" class="external-link">bayesplot_grid</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/pp_check.stanreg.html">pp_check</a></span><span class="op">(</span><span class="va">fit1</span><span class="op">)</span>, <span class="fu"><a href="../reference/pp_check.stanreg.html">pp_check</a></span><span class="op">(</span><span class="va">fit2</span><span class="op">)</span>, </span>
<span>  xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>,  </span>
<span>  ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">4</span><span class="op">)</span>, </span>
<span>  titles <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"True Model: y ~ x | z"</span>, <span class="st">"False Model: y ~ x - 1"</span><span class="op">)</span>,</span>
<span>  grid_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="betareg_files/figure-html/simulated-analysis-1.png" class="r-plt" width="60%" style="display: block; margin: auto;"></p>
<p>We can also compare models by evaluating the expected log pointwise
predictive density (<code>elpd</code>), which can be calculated using
the <code>loo</code> method, which provides an interface for
<strong>rstanarm</strong> models to the functionality in the
<strong>loo</strong> package.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">loo1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/loo.stanreg.html">loo</a></span><span class="op">(</span><span class="va">fit1</span><span class="op">)</span></span>
<span><span class="va">loo2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/loo.stanreg.html">loo</a></span><span class="op">(</span><span class="va">fit2</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/loo.stanreg.html">loo_compare</a></span><span class="op">(</span><span class="va">loo1</span>, <span class="va">loo2</span><span class="op">)</span></span></code></pre></div>
<pre><code>     elpd_diff se_diff
fit1   0.0       0.0  
fit2 -79.9      11.8  </code></pre>
<p>The difference in <code>elpd</code> is negative indicating that the
expected predictive accuracy for the first model is higher.</p>
</div>
<div class="section level2">
<h2 id="an-example-using-gasoline-data">An Example Using Gasoline Data<a class="anchor" aria-label="anchor" href="#an-example-using-gasoline-data"></a>
</h2>
<p>In some applied contexts it may be necessary to work with an outcome
variable that is a proportion. If the proportion is bound on the open
unit interval then beta regression can be considered a reasonable
estimation method. The <code>betareg</code> package provides a dataset
on the proportion of crude oil converted to gasoline after distillation
and fractionation. This variable is defined as yield. Below
<code>stan_betareg</code> is used to model yield as a function of
temperature, pressure, and the batch of conditions.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mc-stan.org/rstanarm/">rstanarm</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"GasolineYield"</span>, package <span class="op">=</span> <span class="st">"betareg"</span><span class="op">)</span></span>
<span><span class="va">gas_fit1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/stan_betareg.html">stan_betareg</a></span><span class="op">(</span><span class="va">yield</span> <span class="op">~</span> <span class="va">temp</span> <span class="op">+</span> <span class="va">batch</span>, data <span class="op">=</span> <span class="va">GasolineYield</span>, link <span class="op">=</span> <span class="st">"logit"</span>,</span>
<span>                         seed <span class="op">=</span> <span class="fl">12345</span><span class="op">)</span></span>
<span><span class="va">gas_fit2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/stan_betareg.html">stan_betareg</a></span><span class="op">(</span><span class="va">yield</span> <span class="op">~</span> <span class="va">temp</span> <span class="op">+</span> <span class="va">batch</span> <span class="op">|</span> <span class="va">pressure</span>,</span>
<span>                         data <span class="op">=</span> <span class="va">GasolineYield</span>, link <span class="op">=</span> <span class="st">"logit"</span>,</span>
<span>                         seed <span class="op">=</span> <span class="fl">12345</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">gas_fit1</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">gas_fit2</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<pre><code>(Intercept)        temp      batch1      batch2      batch3      batch4 
      -5.16        0.01        1.35        0.95        1.15        0.77 
     batch5      batch6      batch7      batch8      batch9       (phi) 
       0.80        0.72        0.33        0.26        0.15       12.04 </code></pre>
<pre><code>      (Intercept)              temp            batch1            batch2 
            -6.06              0.01              1.69              1.29 
           batch3            batch4            batch5            batch6 
             1.53              1.03              1.10              1.01 
           batch7            batch8            batch9 (phi)_(Intercept) 
             0.52              0.47              0.37              5.34 
   (phi)_pressure 
             0.04 </code></pre>
<p>The plots below illustrate simulated values of gasoline yield. While
the first model accounts for variation in batch conditions its
predictions looks somewhat uniform rather than resembling the peaked and
right-skewed behavior of the true data. The second model does a somewhat
better job at capturing the shape of the distribution, however its
location is off as it is centered around 0.50 rather than 0.20.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://mc-stan.org/bayesplot/reference/bayesplot_grid.html" class="external-link">bayesplot_grid</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/pp_check.stanreg.html">pp_check</a></span><span class="op">(</span><span class="va">gas_fit1</span><span class="op">)</span>, <span class="fu"><a href="../reference/pp_check.stanreg.html">pp_check</a></span><span class="op">(</span><span class="va">gas_fit2</span><span class="op">)</span>, </span>
<span>  xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>,  </span>
<span>  ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">5</span><span class="op">)</span>, </span>
<span>  titles <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gas_fit1"</span>, <span class="st">"gas_fit2"</span><span class="op">)</span>,</span>
<span>  grid_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="betareg_files/figure-html/gas-analysis-1.png" class="r-plt" width="60%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gas_loo1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/loo.stanreg.html">loo</a></span><span class="op">(</span><span class="va">gas_fit1</span><span class="op">)</span></span>
<span><span class="va">gas_loo2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/loo.stanreg.html">loo</a></span><span class="op">(</span><span class="va">gas_fit2</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/loo.stanreg.html">loo_compare</a></span><span class="op">(</span><span class="va">gas_loo1</span>, <span class="va">gas_loo2</span><span class="op">)</span></span></code></pre></div>
<pre><code>         elpd_diff se_diff
gas_fit2   0.0       0.0  
gas_fit1 -33.9       3.3  </code></pre>
<p>Evaluating the expected log predictive distribution using
<code>loo</code> reveals that the second of the two models is
preferred.</p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Ferrari, SLP and Cribari-Neto, F (2004) “Beta Regression for Modeling
Rates and Proportions”. <em>Journal of Applied Statistics.</em> Vol. 31,
No. 07, p799-815.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jonah Gabry, Ben Goodrich.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
